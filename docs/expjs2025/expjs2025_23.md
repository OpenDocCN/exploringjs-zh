# 19　Math

> 原文：[`exploringjs.com/js/book/ch_math.html`](https://exploringjs.com/js/book/ch_math.html)

1.  19.1　数据属性

1.  19.2　指数、根、对数

1.  19.3　舍入

    1.  19.3.1　舍入到整数

    1.  19.3.2　舍入浮点数到 32 位和 16 位

1.  19.4　三角函数

1.  19.5　其他各种函数

1.  19.6　来源

`Math` 是一个具有数据属性和数字处理方法的对象。你可以将其视为一个穷人的模块：它是在 JavaScript 有了模块之前创建的。

### 19.1　数据属性

+   `Math.E: number` ES1

    欧拉数，自然对数的底数，大约为 2.7182818284590452354。

+   `Math.LN10: number` ES1

    10 的自然对数，大约为 2.302585092994046。

+   `Math.LN2: number` ES1

    2 的自然对数，大约为 0.6931471805599453。

+   `Math.LOG10E: number` ES1

    以 10 为底的对数 *e*，大约为 0.4342944819032518。

+   `Math.LOG2E: number` ES1

    以 2 为底的对数 *e*，大约为 1.4426950408889634。

+   `Math.PI: number` ES1

    数学常数 π，圆周与直径的比值，大约为 3.1415926535897932。

+   `Math.SQRT1_2: number` ES1

    1/2 的平方根，大约为 0.7071067811865476。

+   `Math.SQRT2: number` ES1

    2 的平方根，大约为 1.4142135623730951。

### 19.2　指数、根、对数

+   `Math.cbrt(x: number): number` ES6

    返回 `x` 的立方根。

    ```js
    > Math.cbrt(8)
    2

    ```

+   `Math.exp(x: number): number` ES1

    返回 *e*^(`x`)（*e* 为欧拉数）。`Math.log()` 的逆函数。

    ```js
    > Math.exp(0)
    1
    > Math.exp(1) === Math.E
    true

    ```

+   `Math.expm1(x: number): number` ES6

    返回 `Math.exp(x)-1`。`Math.log1p()` 的逆函数。非常小的数字（接近 0 的分数）以更高的精度表示。因此，当 `.exp()` 返回接近 1 的值时，此函数返回更精确的值。

+   `Math.log(x: number): number` ES1

    返回 `x` 的自然对数（以 *e* 为底，即欧拉数）。`Math.exp()` 的逆函数。

    ```js
    > Math.log(1)
    0
    > Math.log(Math.E)
    1
    > Math.log(Math.E ** 2)
    2

    ```

+   `Math.log1p(x: number): number` ES6

    返回 `Math.log(1 + x)`。`Math.expm1()` 的逆函数。非常小的数字（接近 0 的分数）以更高的精度表示。因此，当 `.log()` 的参数接近 1 时，你可以向此函数提供更精确的参数。

+   `Math.log10(x: number): number` ES6

    返回以 10 为底的对数 `x`。`10 ** x` 的逆函数。

    ```js
    > Math.log10(1)
    0
    > Math.log10(10)
    1
    > Math.log10(100)
    2

    ```

+   `Math.log2(x: number): number` ES6

    返回以 2 为底的对数 `x`。`2 ** x` 的逆函数。

    ```js
    > Math.log2(1)
    0
    > Math.log2(2)
    1
    > Math.log2(4)
    2

    ```

+   `Math.pow(x: number, y: number): number` ES1

    返回 `x`^(`y`），`x` 的 `y` 次幂。等同于 `x ** y`。

    ```js
    > Math.pow(2, 3)
    8
    > Math.pow(25, 0.5)
    5

    ```

+   `Math.sqrt(x: number): number` ES1

    返回 `x` 的平方根。`x ** 2` 的逆函数。

    ```js
    > Math.sqrt(9)
    3

    ```

### 19.3　舍入

#### 19.3.1　舍入到整数

舍入到整数意味着将任意数转换为整数（一个没有小数部分的数）。以下函数实现了多种实现此目的的方法。

+   `Math.ceil(x: number): number` ES1

    返回最小的（最接近-∞）整数`i`，使得`x` ≤ `i`。

    ```js
    > Math.ceil(2.1)
    3
    > Math.ceil(2.9)
    3

    ```

+   `Math.floor(x: number): number` ES1

    返回最大的（最接近+∞）整数`i`，使得`i` ≤ `x`。

    ```js
    > Math.floor(2.1)
    2
    > Math.floor(2.9)
    2

    ```

+   `Math.round(x: number): number` ES1

    返回最接近`x`的整数。如果`x`的小数部分是`.5`，则`.round()`向上舍入（到更接近正无穷大的整数）：

    ```js
    > Math.round(2.4)
    2
    > Math.round(2.5)
    3

    ```

+   `Math.trunc(x: number): number` ES6

    移除`x`的小数部分并返回结果整数。

    ```js
    > Math.trunc(2.1)
    2
    > Math.trunc(2.9)
    2

    ```

表 19.1 显示了几个代表性输入的舍入函数的结果。

|  | `-2.9` | `-2.5` | `-2.1` | `2.1` | `2.5` | `2.9` |
| --- | --- | --- | --- | --- | --- | --- |
| `Math.floor` | `-3` | `-3` | `-3` | `2` | `2` | `2` |
| `Math.ceil` | `-2` | `-2` | `-2` | `3` | `3` | `3` |
| `Math.round` | `-3` | `-2` | `-2` | `2` | `3` | `3` |
| `Math.trunc` | `-2` | `-2` | `-2` | `2` | `2` | `2` |

表 19.1: `Math`的舍入函数。注意负数时情况的变化，因为“更大”总是意味着“更接近正无穷大”。

#### 19.3.2 将浮点数舍入到 32 位和 16 位

+   `Math.fround(x: number): number` ES6

    将`x`舍入到 32 位单浮点数（在 64 位双精度浮点数内）：

    ```js
    > Math.fround(2**128)
    Infinity
    > 2**128
    3.402823669209385e+38

    > Math.fround(2**-150)
    0
    > 2**-150
    7.006492321624085e-46

    ```

+   `Math.f16round(x: number): number` ES2025

    将`x`舍入到 16 位半浮点数（在 64 位双精度浮点数内）：

    ```js
    > Math.f16round(2**16)
    Infinity
    > 2**16
    65536

    > Math.f16round(2**-25)
    0
    > 2**-25
    2.9802322387695312e-8

    ```

##### 19.3.2.1 处理溢出和下溢

`Math.f16round(x)`将`x`舍入到 16 位半浮点数（在 64 位双精度浮点数内）。

如果存在正溢出（正数离零太远），则结果为正无穷大：

```js
> Math.f16round(2**15)
32768
> Math.f16round(2**16)
Infinity
> 2**16
65536

```

如果存在负溢出（负数离零太远），则结果为负无穷大：

```js
> Math.f16round(-(2**15))
-32768
> Math.f16round(-(2**16))
-Infinity
> -(2**16)
-65536

```

算术下溢意味着一个数在二进制小数点后有太多数字（太接近整数）。如果发生这种情况，无法表示的数字将被省略：

```js
> Math.f16round(2**-24)
5.960464477539063e-8
> Math.f16round(2**-25)
0
> 2**-25
2.9802322387695312e-8

```

### 19.4 三角函数

所有角度均以弧度为单位。使用以下两个函数在度与弧度之间进行转换。

```js
function degreesToRadians(degrees) {
  return degrees / 180 * Math.PI;
}
assert.equal(degreesToRadians(90), Math.PI/2);

function radiansToDegrees(radians) {
  return radians / Math.PI * 180;
}
assert.equal(radiansToDegrees(Math.PI), 180);

```

+   `Math.acos(x: number): number` ES1

    返回`x`的反正切（反余弦）值。

    ```js
    > Math.acos(0)
    1.5707963267948966
    > Math.acos(1)
    0

    ```

+   `Math.acosh(x: number): number` ES6

    返回`x`的反双曲余弦值。

+   `Math.asin(x: number): number` ES1

    返回`x`的正弦值。

    ```js
    > Math.asin(0)
    0
    > Math.asin(1)
    1.5707963267948966

    ```

+   `Math.asinh(x: number): number` ES6

    返回`x`的反双曲正弦值。

+   `Math.atan(x: number): number` ES1

    返回`x`的反正切（反切）值。

+   `Math.atanh(x: number): number` ES6

    返回`x`的反双曲正切值。

+   `Math.atan2(y: number, x: number): number` ES1

    返回`y/x`的商的反正切。

+   `Math.cos(x: number): number` ES1

    返回`x`的余弦值。

    ```js
    > Math.cos(0)
    1
    > Math.cos(Math.PI)
    -1

    ```

+   `Math.cosh(x: number): number` ES6

    返回`x`的双曲余弦值。

+   `Math.hypot(...values: Array<number>): number` ES6

    返回 `values` 的平方和的平方根（毕达哥拉斯定理）：

    ```js
    > Math.hypot(3, 4)
    5

    ```

+   `Math.sin(x: number): number` ES1

    返回 `x` 的正弦。

    ```js
    > Math.sin(0)
    0
    > Math.sin(Math.PI / 2)
    1

    ```

+   `Math.sinh(x: number): number` ES6

    返回 `x` 的双曲正弦。

+   `Math.tan(x: number): number` ES1

    返回 `x` 的正切。

    ```js
    > Math.tan(0)
    0
    > Math.tan(1)
    1.5574077246549023

    ```

+   `Math.tanh(x: number): number;` ES6

    返回 `x` 的双曲正切。

### 19.5 其他各种函数

+   `Math.abs(x: number): number` ES1

    返回 `x` 的绝对值。

    ```js
    > Math.abs(3)
    3
    > Math.abs(-3)
    3
    > Math.abs(0)
    0

    ```

+   `Math.clz32(x: number): number` ES6

    计算在 32 位整数 `x` 中的前导零位。用于数字信号处理算法。

    ```js
    > Math.clz32(0b01000000000000000000000000000000)
    1
    > Math.clz32(0b00100000000000000000000000000000)
    2
    > Math.clz32(2)
    30
    > Math.clz32(1)
    31

    ```

+   `Math.max(...values: Array<number>): number` ES1

    将 `values` 转换为数字并返回最大值。

    ```js
    > Math.max(3, -5, 24)
    24

    ```

+   `Math.min(...values: Array<number>): number` ES1

    将 `values` 转换为数字并返回最小值。

    ```js
    > Math.min(3, -5, 24)
    -5

    ```

+   `Math.random(): number` ES1

    返回一个伪随机数 `n`，其中 0 ≤ `n` < 1。

    ```js
    /** Returns a random integer i with 0 <= i < max */
    function getRandomInteger(max) {
      return Math.floor(Math.random() * max);
    }

    ```

+   `Math.sign(x: number): number` ES6

    返回一个数字的符号：

    ```js
    > Math.sign(-8)
    -1
    > Math.sign(0)
    0
    > Math.sign(3)
    1

    ```

### 19.6 源

+   维基百科

+   [TypeScript 内置类型定义](https://github.com/microsoft/TypeScript/tree/main/src/lib/)

+   [MDN 网页文档 JavaScript](https://developer.mozilla.org/en-US/docs/Web/JavaScript)

+   [ECMAScript 语言规范](https://tc39.es/ecma262/)
