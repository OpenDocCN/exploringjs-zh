["```js\nasync function fetchJsonAsync(url) {\n  try {\n    const request = await fetch(url); // async\n    const text = await request.text(); // async\n    return JSON.parse(text); // sync\n  }\n  catch (error) {\n    assert.fail(error);\n  }\n}\n\n```", "```js\nfunction fetchJsonViaPromises(url) {\n  return fetch(url) // async\n  .then(request => request.text()) // async\n  .then(text => JSON.parse(text)) // sync\n  .catch((error) => {\n    assert.fail(error);\n  });\n}\n\n```", "```js\nfetchJsonAsync('http://example.com/person.json')\n.then((obj) => {\n  assert.deepEqual(obj, {\n    first: 'Jane',\n    last: 'Doe',\n  });\n});\n\n```", "```js\n    async function f() {\n     assert.equal(\n     await Promise.resolve('fulfilled'),\n     'fulfilled'\n     );\n    }\n\n    ```", "```js\n    async function f() {\n     try {\n     await Promise.reject('rejected');\n     } catch (err) {\n     assert.equal(err, 'rejected');\n     }\n    }\n\n    ```", "```js\n    async function f1() { return 'fulfilled' }\n    f1().then(\n     result => assert.equal(result, 'fulfilled')\n    );\n\n    ```", "```js\n    async function f() { throw 'rejected' }\n    f().catch(\n     error => assert.equal(error, 'rejected')\n    );\n\n    ```", "```js\n// Async function declaration\nasync function func1() {}\n\n// Async function expression\nconst func2 = async function () {};\n\n// Async arrow function\nconst func3 = async () => {};\n\n// Async method definition in an object literal\nconst obj = { async m() {} };\n\n// Async method definition in a class definition\nclass MyClass { async m() {} } \n```", "```js\nassert.equal(\n  await Promise.resolve('fulfilled'), 'fulfilled'\n);\n\n```", "```js\nasync function awaitPromise() {\n queueMicrotask( // (A)\n () => console.log('OTHER TASK')\n );\n console.log('before');\n await Promise.resolve('fulfilled');\n console.log('after');\n}\nawait awaitPromise();\n\n```", "```js\nbefore\nOTHER TASK\nafter\n\n```", "```js\ntry {\n  await Promise.reject(\n    new Error('Problem!')\n  );\n  assert.fail(); // we never get here\n} catch (err) {\n  assert.deepEqual(err, new Error('Problem!'));\n}\n\n```", "```js\nassert.equal(\n  await 'non-Promise value', 'non-Promise value'\n);\n\n```", "```js\nasync function awaitNonPromiseValue() {\n queueMicrotask(() => console.log('OTHER TASK'));\n console.log('before');\n await 'non-Promise value';\n console.log('after');\n}\nawait awaitNonPromiseValue();\n\n```", "```js\nbefore\nOTHER TASK\nafter\n\n```", "```js\nlet mylib;\ntry {\n  mylib = await import('https://primary.example.com/mylib');\n} catch {\n  mylib = await import('https://secondary.example.com/mylib');\n}\n\n```", "```js\nasync function f() {\n const nestedFunc = () => {\n const result = await Promise.resolve('abc'); // SyntaxError!\n return 'RESULT: ' + result;\n };\n return [ nestedFunc() ];\n} \n```", "```js\nasync function f() {\n const nestedFunc = async () => {\n const result = await Promise.resolve('abc'); // (A)\n return 'RESULT: ' + result;\n };\n return [ nestedFunc() ]; // (B)\n}\nconst arr = await f(); // (C)\nassert.equal(\n arr[0] instanceof Promise, true\n); \n```", "```js\nasync function f() {\n const nestedFunc = async () => {\n const result = await Promise.resolve('abc');\n return 'RESULT: ' + result;\n };\n return [ await nestedFunc() ];\n}\nassert.deepEqual(\n await f(), ['RESULT: abc']\n); \n```", "```js\nconst arrayOfPromises = arr.map(\n  async (x) => { /*···*/ }\n);\n\n```", "```js\nconst array = await Promise.all(\n  arr.map(\n    async (x) => { /*···*/ }\n  )\n);\n\n```", "```js\nconst urls = [\n  'http://example.com/file1.txt',\n  'http://example.com/file2.txt',\n];\nconst uppercaseTexts = await Promise.all( // (A)\n  urls.map(async (url) => {\n    const response = await fetch(url);\n    const text = await response.text();\n    return text.toUpperCase();\n  })\n);\nassert.deepEqual(\n  uppercaseTexts,\n  ['FILE1.TXT', 'FILE2.TXT']\n);\n\n```", "```js\nasync function asyncFunc() {\n return 123; // (A)\n}\n\nasyncFunc()\n.then((result) => {\n assert.equal(result, 123);\n});\n\n```", "```js\nasync function asyncFunc() {}\n\nasyncFunc()\n.then((result) => {\n assert.equal(result, undefined);\n});\n\n```", "```js\nasync function asyncFunc() {\n throw new Error('Problem!'); // (A)\n}\n\nasyncFunc()\n.catch((err) => {\n assert.deepEqual(err, new Error('Problem!'));\n});\n\n```", "```js\nasync function asyncFunc1() {\n return Promise.resolve('fulfilled');\n}\nconst p1 = asyncFunc1();\np1.then(\n result => assert.equal(result, 'fulfilled')\n);\n\n```", "```js\nasync function asyncFunc2() {\n return Promise.reject('rejected');\n}\nconst p2 = asyncFunc2();\np2.catch(\n error => assert.equal(error, 'rejected')\n);\n\n```", "```js\nasync function asyncFunc() {\n console.log('asyncFunc() starts'); // (A)\n return 'abc';\n}\nasyncFunc().\nthen((x) => { // (B)\n console.log(`Resolved: ${x}`);\n});\nconsole.log('Task ends'); // (C)\n\n```", "```js\nasyncFunc() starts\nTask ends\nResolved: abc\n\n```", "```js\nasync function asyncFunc() {\n const writer = openFile('someFile.txt');\n writer.write('hello'); // don’t wait\n writer.write('world'); // don’t wait\n await writer.close(); // wait for file to close\n}\n\n```", "```js\nawait longRunningAsyncOperation();\nconsole.log('Done!');\n\n```", "```js\nasync function f() {\n return await Promise.resolve('result');\n}\n\n```", "```js\nasync function f() {\n return Promise.resolve('result');\n}\n\n```", "```js\nasync function f() {\n try {\n return await Promise.reject('error'); // (A)\n } catch (err) {\n return 'Caught an error: ' + err;\n }\n}\nf().then((result) => {\n assert.equal(result, 'Caught an error: error');\n});\n\n```", "```js\nasync function f() {\n try {\n return Promise.reject('error');\n } catch (err) {\n return 'Caught an error: ' + err;\n }\n}\nf().catch((reason) => {\n assert.equal(reason, 'error');\n});\n\n```", "```js\nasync function returnAfterPause(id) {\n  console.log('START ' + id);\n  await delay(10); // pause\n  console.log('END ' + id);\n  return id;\n}\n\n/**\n * Resolves after `ms` milliseconds\n */\nfunction delay(ms) {\n  return new Promise((resolve, _reject) => {\n    setTimeout(resolve, ms);\n  });\n}\n\n```", "```js\nasync function sequentialAwait() {\n const result1 = await returnAfterPause('first');\n assert.equal(result1, 'first');\n\n const result2 = await returnAfterPause('second');\n assert.equal(result2, 'second');\n}\n\n```", "```js\nSTART first\nEND first\nSTART second\nEND second\n\n```", "```js\nasync function concurrentPromiseAll() {\n const result = await Promise.all([\n returnAfterPause('first'),\n returnAfterPause('second'),\n ]);\n assert.deepEqual(result, ['first', 'second']);\n}\n\n```", "```js\nSTART first\nSTART second\nEND first\nEND second\n\n```", "```js\nasync function concurrentAwait() {\n const resultPromise1 = returnAfterPause('first');\n const resultPromise2 = returnAfterPause('second');\n\n assert.equal(await resultPromise1, 'first');\n assert.equal(await resultPromise2, 'second');\n}\n\n```", "```js\nSTART first\nSTART second\nEND first\nEND second\n\n```"]