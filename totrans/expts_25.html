<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>20 Intersections of object types</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>20 Intersections of object types</h1>
<blockquote>原文：<a href="https://exploringjs.com/ts/book/ch_intersections-object-types.html">https://exploringjs.com/ts/book/ch_intersections-object-types.html</a></blockquote>

    
        <div id="adbox">
      <div id="adbox-explain">(Ad, please don’t block.)</div>
              
          </div>
    
    
<nav class="local-toc">
  <ol>
    <li>
      <a href="#intersections-of-object-types">20.1 Intersections of object types</a>
      <ol>
        <li>
          <a href="#extending-vs-intersection">20.1.1 Extending vs. intersection</a>
        </li>
        <li>
          <a href="#NonNullable">20.1.2 Example: <code>NonNullable</code> (<code>T &amp; {}</code>)</a>
        </li>
        <li>
          <a href="#example-inferred-intersections">20.1.3 Example: inferred intersections</a>
        </li>
        <li>
          <a href="#example-combining-two-object-types-via-an-intersection">20.1.4 Example: combining two object types via an intersection</a>
        </li>
      </ol>
    </li>
  </ol>
</nav>
<p>In this chapter, we explore what intersections of object types can be used for in TypeScript.</p>
<p>In this chapter, <em>object type</em> means:</p>
<ul>
  <li>
    Object literal type
  </li>
  <li>
    Interface type
  </li>
  <li>
    Mapped type (such as <code>Record</code>)
  </li>
</ul>
<h3 id="intersections-of-object-types"><a class="heading-id-link" href="#intersections-of-object-types">20.1 Intersections of object types</a></h3>
<p>The intersection of two object types has the properties of both:</p>
<pre class="language-ts">
<code><span class="hljs-keyword">type</span> <span class="hljs-title class_">Obj1</span> = { <span class="hljs-attr">prop1</span>: <span class="hljs-built_in">boolean</span> };</code>
<code><span class="hljs-keyword">type</span> <span class="hljs-title class_">Obj2</span> = { <span class="hljs-attr">prop2</span>: <span class="hljs-built_in">number</span> };</code>
<code/>
<code><span class="hljs-keyword">const</span> <span class="hljs-attr">obj</span>: <span class="hljs-title class_">Obj1</span> &amp; <span class="hljs-title class_">Obj2</span> = {</code>
<code>  <span class="hljs-attr">prop1</span>: <span class="hljs-literal">true</span>,</code>
<code>  <span class="hljs-attr">prop2</span>: <span class="hljs-number">123</span>,</code>
<code>};</code>
</pre>
<h4 id="extending-vs-intersection"><a class="heading-id-link" href="#extending-vs-intersection">20.1.1 Extending vs. intersection</a></h4>
<p>With interfaces, we can use <code>extends</code> to add properties:</p>
<pre class="language-ts">
<code><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Person</span> {</code>
<code>  <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>;</code>
<code>}</code>
<code><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Employe</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">Person</span> {</code>
<code>  <span class="hljs-attr">company</span>: <span class="hljs-built_in">string</span>;</code>
<code>}</code>
</pre>
<p>With object types, we can use an intersection:</p>
<pre class="language-ts">
<code><span class="hljs-keyword">type</span> <span class="hljs-title class_">Person</span> = {</code>
<code>  <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>,</code>
<code>};</code>
<code/>
<code><span class="hljs-keyword">type</span> <span class="hljs-title class_">Employee</span> =</code>
<code>  &amp; <span class="hljs-title class_">Person</span></code>
<code>  &amp; {</code>
<code>    <span class="hljs-attr">company</span>: <span class="hljs-built_in">string</span>,</code>
<code>  }</code>
<code>;</code>
</pre>
<p>One caveat is that only <code>extends</code> supports overriding. For more information, see <a href="ch_typing-objects.html#extending-interfaces">$type</a>.</p>
<h4 id="NonNullable"><a class="heading-id-link" href="#NonNullable">20.1.2 Example: <code>NonNullable</code> (<code>T &amp; {}</code>)</a></h4>
<pre class="language-ts">
<code><span class="hljs-comment">/**</span></code>
<code><span class="hljs-comment"> * Exclude null and undefined from T</span></code>
<code><span class="hljs-comment"> */</span></code>
<code><span class="hljs-keyword">type</span> <span class="hljs-title class_">NonNullable</span>&lt;T&gt; = T &amp; {};</code>
<code/>
<code><span class="hljs-keyword">type</span> _ = [</code>
<code>  <span class="hljs-title class_">Assert</span>&lt;<span class="hljs-title class_">Equal</span>&lt;</code>
<code>    <span class="hljs-title class_">NonNullable</span>&lt;<span class="hljs-literal">undefined</span> | <span class="hljs-built_in">string</span>&gt;,</code>
<code>    <span class="hljs-built_in">string</span></code>
<code>  &gt;&gt;,</code>
<code>  <span class="hljs-title class_">Assert</span>&lt;<span class="hljs-title class_">Equal</span>&lt;</code>
<code>    <span class="hljs-title class_">NonNullable</span>&lt;<span class="hljs-literal">null</span> | <span class="hljs-built_in">string</span>&gt;,</code>
<code>    <span class="hljs-built_in">string</span></code>
<code>  &gt;&gt;,</code>
<code>  <span class="hljs-title class_">Assert</span>&lt;<span class="hljs-title class_">Equal</span>&lt;</code>
<code>    <span class="hljs-title class_">NonNullable</span>&lt;<span class="hljs-built_in">string</span>&gt;, <span class="hljs-comment">// (A)</span></code>
<code>    <span class="hljs-built_in">string</span></code>
<code>  &gt;&gt;,</code>
<code>];</code>
</pre>
<p>The result of <code>NonNullable&lt;T&gt;</code> is a type that is the intersection of <code>T</code> and all non-nullish values.</p>
<p>It’s interesting that <code>string &amp; {}</code> is <code>string</code> (line A).</p>
<h4 id="example-inferred-intersections"><a class="heading-id-link" href="#example-inferred-intersections">20.1.3 Example: inferred intersections</a></h4>
<p>The following code shows how the inferred type of <code>obj</code> changes when we use the built-in type guard <code>in</code> (line A and line B):</p>
<pre class="language-ts">
<code><span class="hljs-keyword">function</span> <span class="hljs-title function_">func</span>(<span class="hljs-params">obj: <span class="hljs-built_in">object</span></span>) {</code>
<code>  <span class="hljs-keyword">if</span> (<span class="hljs-string">'prop1'</span> <span class="hljs-keyword">in</span> obj) { <span class="hljs-comment">// (A)</span></code>
<code>    assertType&lt;</code>
<code>      <span class="hljs-built_in">object</span> &amp; <span class="hljs-title class_">Record</span>&lt;<span class="hljs-string">'prop1'</span>, <span class="hljs-built_in">unknown</span>&gt;</code>
<code>    &gt;(obj);</code>
<code>    <span class="hljs-keyword">if</span> (<span class="hljs-string">'prop2'</span> <span class="hljs-keyword">in</span> obj) { <span class="hljs-comment">// (B)</span></code>
<code>      assertType&lt;</code>
<code>      <span class="hljs-built_in">object</span> &amp; <span class="hljs-title class_">Record</span>&lt;<span class="hljs-string">'prop1'</span>, <span class="hljs-built_in">unknown</span>&gt; &amp; <span class="hljs-title class_">Record</span>&lt;<span class="hljs-string">'prop2'</span>, <span class="hljs-built_in">unknown</span>&gt;</code>
<code>      &gt;(obj);</code>
<code>    }</code>
<code>  }</code>
<code>}</code>
</pre>
<h4 id="example-combining-two-object-types-via-an-intersection"><a class="heading-id-link" href="#example-combining-two-object-types-via-an-intersection">20.1.4 Example: combining two object types via an intersection</a></h4>
<p>In the next example, we combine the type <code>Obj</code> of a parameter with the type <code>WithKey</code> – by adding the property <code>.key</code> of <code>WithKey</code> to the parameter:</p>
<pre class="language-ts">
<code><span class="hljs-keyword">type</span> <span class="hljs-title class_">WithKey</span> = {</code>
<code>  <span class="hljs-attr">key</span>: <span class="hljs-built_in">string</span>,</code>
<code>};</code>
<code><span class="hljs-keyword">function</span> addKey&lt;<span class="hljs-title class_">Obj</span> <span class="hljs-keyword">extends</span> <span class="hljs-built_in">object</span>&gt;(<span class="hljs-attr">obj</span>: <span class="hljs-title class_">Obj</span>, <span class="hljs-attr">key</span>: <span class="hljs-built_in">string</span>)</code>
<code>  : <span class="hljs-title class_">Obj</span> &amp; <span class="hljs-title class_">WithKey</span></code>
<code>{</code>
<code>  <span class="hljs-keyword">const</span> objWithKey = obj <span class="hljs-keyword">as</span> (<span class="hljs-title class_">Obj</span> &amp; <span class="hljs-title class_">WithKey</span>);</code>
<code>  objWithKey.<span class="hljs-property">key</span> = key;</code>
<code>  <span class="hljs-keyword">return</span> objWithKey;</code>
<code>}</code>
</pre>
<p><code>addKey()</code> is used like this:</p>
<pre class="language-ts">
<code><span class="hljs-keyword">const</span> paris = {</code>
<code>  <span class="hljs-attr">city</span>: <span class="hljs-string">'Paris'</span>,</code>
<code>};</code>
<code/>
<code><span class="hljs-keyword">const</span> parisWithKey = <span class="hljs-title function_">addKey</span>(paris, <span class="hljs-string">'paris'</span>);</code>
<code>assertType&lt;</code>
<code>{ </code>
<code>  <span class="hljs-attr">city</span>: <span class="hljs-built_in">string</span>,</code>
<code>  <span class="hljs-attr">key</span>: <span class="hljs-built_in">string</span>,</code>
<code>}</code>
<code>&gt;(parisWithKey);</code>
</pre>

    
      
</body>
</html>