<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>21‚ÄÉUnicode ‚Äì a brief introduction (advanced)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>21‚ÄÉUnicode ‚Äì a brief introduction (advanced)</h1>
<blockquote>ÂéüÊñáÔºö<a href="https://exploringjs.com/js/book/ch_unicode.html">https://exploringjs.com/js/book/ch_unicode.html</a></blockquote>

        
    
    
    
<nav class="local-toc">
  <ol>
    <li>
      <a href="#unicode-code-points-vs-code-units">21.1‚ÄÉCode points vs. code units</a>
      <ol>
        <li>
          <a href="#unicode-code-points">21.1.1‚ÄÉCode points</a>
        </li>
        <li>
          <a href="#encoding-unicode-code-points-utf32-utf16-utf8">21.1.2‚ÄÉEncoding Unicode code points: UTF-32, UTF-16, UTF-8</a>
        </li>
      </ol>
    </li>
    <li>
      <a href="#utf-in-web-dev">21.2‚ÄÉEncodings used in web development: UTF-16 and UTF-8</a>
      <ol>
        <li>
          <a href="#source-code-internally-utf16">21.2.1‚ÄÉSource code internally: UTF-16</a>
        </li>
        <li>
          <a href="#strings-utf16">21.2.2‚ÄÉStrings: UTF-16</a>
        </li>
        <li>
          <a href="#source-code-in-files-utf8">21.2.3‚ÄÉSource code in files: UTF-8</a>
        </li>
      </ol>
    </li>
    <li>
      <a href="#grapheme-clusters">21.3‚ÄÉGrapheme clusters ‚Äì the real characters</a>
      <ol>
        <li>
          <a href="#grapheme-clusters-vs-glyphs">21.3.1‚ÄÉGrapheme clusters vs. glyphs</a>
        </li>
      </ol>
    </li>
  </ol>
</nav>
<p><span id="index-entry-Unicode"/></p>
<p>Unicode is a standard for representing and managing text in most of the world‚Äôs writing systems. Virtually all modern software that works with text, supports Unicode. The standard is maintained by the Unicode Consortium. A new version of the standard is published every year (with new emojis, etc.). Unicode version 1.0.0 was published in October 1991.</p>
<h3 id="unicode-code-points-vs-code-units"><a class="heading-id-link" href="#unicode-code-points-vs-code-units">21.1‚ÄÉCode points vs. code units</a></h3>
<p><span id="index-entry-code-point"/><span id="index-entry-code-unit"/></p>
<p>Two concepts are crucial for understanding Unicode:</p>
<ul>
  <li>
    <em>Code points</em> are numbers that represent the atomic parts of Unicode text. Most of them represent visible symbols but they can also have other meanings such as specifying an aspect of a symbol (the accent of a letter, the skin tone of an emoji, etc.).
  </li>
  <li>
    <em>Code units</em> are numbers that encode code points, to store or transmit Unicode text. One or more code units encode a single code point. Each code unit has the same size, which depends on the <em>encoding format</em> that is used. The most popular format, UTF-8, has 8-bit code units.
  </li>
</ul>
<h4 id="unicode-code-points"><a class="heading-id-link" href="#unicode-code-points">21.1.1‚ÄÉCode points</a></h4>
<p>The first version of Unicode had 16-bit code points. Since then, the number of characters has grown considerably and the size of code points was extended to 21 bits. These 21 bits are partitioned in 17 planes, with 16 bits each:</p>
<ul>
  <li>
    Plane 0: <strong>Basic Multilingual Plane (BMP)</strong>, 0x0000‚Äì0xFFFF
    <ul>
      <li>
        Contains characters for almost all modern languages (Latin characters, Asian characters, etc.) and many symbols.
      </li>
    </ul>
  </li>
  <li>
    Plane 1: Supplementary Multilingual Plane (SMP), 0x10000‚Äì0x1FFFF
    <ul>
      <li>
        Supports historic writing systems (e.g., Egyptian hieroglyphs and cuneiform) and additional modern writing systems.
      </li>
      <li>
        Supports emojis and many other symbols.
      </li>
    </ul>
  </li>
  <li>
    Plane 2: Supplementary Ideographic Plane (SIP), 0x20000‚Äì0x2FFFF
    <ul>
      <li>
        Contains additional CJK (Chinese, Japanese, Korean) ideographs.
      </li>
    </ul>
  </li>
  <li>
    Plane 3‚Äì13: Unassigned
  </li>
  <li>
    Plane 14: Supplementary Special-Purpose Plane (SSP), 0xE0000‚Äì0xEFFFF
    <ul>
      <li>
        Contains non-graphical characters such as tag characters and glyph variation selectors.
      </li>
    </ul>
  </li>
  <li>
    Plane 15‚Äì16: Supplementary Private Use Area (S PUA A/B), 0x0F0000‚Äì0x10FFFF
    <ul>
      <li>
        Available for character assignment by parties outside the ISO and the Unicode Consortium. Not standardized.
      </li>
    </ul>
  </li>
</ul>
<p>Planes 1-16 are called supplementary planes or <strong>astral planes</strong>.</p>
<p>Let‚Äôs check the code points of a few characters:</p>
<pre class="language-node-repl">
<span class="hljs-meta prompt_">&gt;</span> <span class="language-javascript"><span class="hljs-string">'A'</span>.<span class="hljs-title function_">codePointAt</span>(<span class="hljs-number">0</span>).<span class="hljs-title function_">toString</span>(<span class="hljs-number">16</span>)</span>
'41'
<span class="hljs-meta prompt_">&gt;</span> <span class="language-javascript"><span class="hljs-string">'√º'</span>.<span class="hljs-title function_">codePointAt</span>(<span class="hljs-number">0</span>).<span class="hljs-title function_">toString</span>(<span class="hljs-number">16</span>)</span>
'fc'
<span class="hljs-meta prompt_">&gt;</span> <span class="language-javascript"><span class="hljs-string">'œÄ'</span>.<span class="hljs-title function_">codePointAt</span>(<span class="hljs-number">0</span>).<span class="hljs-title function_">toString</span>(<span class="hljs-number">16</span>)</span>
'3c0'
<span class="hljs-meta prompt_">&gt;</span> <span class="language-javascript"><span class="hljs-string">'üôÇ'</span>.<span class="hljs-title function_">codePointAt</span>(<span class="hljs-number">0</span>).<span class="hljs-title function_">toString</span>(<span class="hljs-number">16</span>)</span>
'1f642'
</pre>
<p>The hexadecimal numbers of the code points tell us that the first three characters reside in plane 0 (within 16 bits), while the emoji resides in plane 1.</p>
<h4 id="encoding-unicode-code-points-utf32-utf16-utf8"><a class="heading-id-link" href="#encoding-unicode-code-points-utf32-utf16-utf8">21.1.2‚ÄÉEncoding Unicode code points: UTF-32, UTF-16, UTF-8</a></h4>
<p><span id="index-entry-Unicode-Transformation-Format--UTF-"/><span id="index-entry-UTF--Unicode-Transformation-Format-"/></p>
<p>The main ways of encoding code points are three <em>Unicode Transformation Formats</em> (UTFs): UTF-32, UTF-16, UTF-8. The number at the end of each format indicates the size (in bits) of its code units.</p>
<h5 id="utf32-unicode-transformation-format-32"><a class="heading-id-link" href="#utf32-unicode-transformation-format-32">21.1.2.1‚ÄÉUTF-32 (Unicode Transformation Format 32)</a></h5>
<p><span id="index-entry-UTF-32"/></p>
<p>UTF-32 uses 32 bits to store code units, resulting in one code unit per code point. This format is the only one with <em>fixed-length encoding</em>; all others use a varying number of code units to encode a single code point.</p>
<h5 id="utf-16"><a class="heading-id-link" href="#utf-16">21.1.2.2‚ÄÉUTF-16 (Unicode Transformation Format 16)</a></h5>
<p><span id="index-entry-UTF-16"/></p>
<p>UTF-16 uses 16-bit code units. It encodes code points as follows:</p>
<p><span id="index-entry-leading-surrogate"/><span id="index-entry-surrogate--leading"/>
<span id="index-entry-trailing-surrogate"/><span id="index-entry-surrogate--trailing"/></p>
<ul>
  <li>
    <p>The BMP (first 16 bits of Unicode) is stored in single code units.</p>
  </li>
  <li>
    <p>Astral planes: The BMP comprises 0x10_000 code points. Given that Unicode has a total of 0x110_000 code points, we still need to encode the remaining 0x100_000 code points (20 bits). The BMP has two ranges of unassigned code points that provide the necessary storage:</p>
    <ul>
      <li>
        Most significant 10 bits (<em>leading surrogate</em>, <em>high surrogate</em>): 0xD800-0xDBFF
      </li>
      <li>
        Least significant 10 bits (<em>trailing surrogate</em>, <em>low surrogate</em>): 0xDC00-0xDFFF
      </li>
    </ul>
  </li>
</ul>
<p>As a consequence, each UTF-16 code unit is either:</p>
<p><span id="index-entry-Unicode-scalar"/><span id="index-entry-Unicode-scalar2"/></p>
<ul>
  <li>
    A BMP code point (a <em>scalar</em>)
  </li>
  <li>
    A leading surrogate
  </li>
  <li>
    A trailing surrogate
  </li>
</ul>
<p>If a surrogate appears on its own, without its partner, it is called a <span id="unicode-lone-surrogate"><em>lone surrogate</em></span>.</p>
<p><span id="index-entry-surrogate--lone"/></p>
<p>This is how the bits of the code points are distributed among the surrogates:</p>
<pre>
0bhhhhhhhhhhllllllllll // code point - 0x10000
0b110110hhhhhhhhhh     // 0xD800 + 0bhhhhhhhhhh
0b110111llllllllll     // 0xDC00 + 0bllllllllll
</pre>
<p>Each character of a JavaScript string is a UTF-16 code unit. As an example, consider code point 0x1F642 (üôÇ) that is represented by two UTF-16 code units ‚Äì 0xD83D and 0xDE42:</p>
<pre class="language-node-repl">
<span class="hljs-meta prompt_">&gt;</span> <span class="language-javascript"><span class="hljs-string">'üôÇ'</span>.<span class="hljs-title function_">codePointAt</span>(<span class="hljs-number">0</span>).<span class="hljs-title function_">toString</span>(<span class="hljs-number">16</span>)</span>
'1f642'
<span class="hljs-meta prompt_">&gt;</span> <span class="language-javascript"><span class="hljs-string">'üôÇ'</span>.<span class="hljs-property">length</span></span>
2
<span class="hljs-meta prompt_">&gt;</span> <span class="language-javascript"><span class="hljs-string">'üôÇ'</span>.<span class="hljs-title function_">split</span>(<span class="hljs-string">''</span>)</span>
[ '\uD83D', '\uDE42' ]
</pre>
<p>Let‚Äôs derive the code units from the code point:</p>
<pre class="language-node-repl">
<span class="hljs-meta prompt_">&gt;</span> <span class="language-javascript">(<span class="hljs-number">0x1F642</span> - <span class="hljs-number">0x10000</span>).<span class="hljs-title function_">toString</span>(<span class="hljs-number">2</span>).<span class="hljs-title function_">padStart</span>(<span class="hljs-number">20</span>, <span class="hljs-string">'0'</span>)</span>
'00001111011001000010'
<span class="hljs-meta prompt_">&gt;</span> <span class="language-javascript">(<span class="hljs-number">0xD800</span> + <span class="hljs-number">0b0000111101</span>).<span class="hljs-title function_">toString</span>(<span class="hljs-number">16</span>)</span>
'd83d'
<span class="hljs-meta prompt_">&gt;</span> <span class="language-javascript">(<span class="hljs-number">0xDC00</span> + <span class="hljs-number">0b1001000010</span>).<span class="hljs-title function_">toString</span>(<span class="hljs-number">16</span>)</span>
'de42'
</pre>
<p>In contrast, code point 0x03C0 (œÄ) is part of the BMP and therefore represented by a single UTF-16 code unit ‚Äì 0x03C0:</p>
<pre class="language-node-repl">
<span class="hljs-meta prompt_">&gt;</span> <span class="language-javascript"><span class="hljs-string">'œÄ'</span>.<span class="hljs-property">length</span></span>
1
</pre>
<h5 id="utf8-unicode-transformation-format-8"><a class="heading-id-link" href="#utf8-unicode-transformation-format-8">21.1.2.3‚ÄÉUTF-8 (Unicode Transformation Format 8)</a></h5>
<p><span id="index-entry-UTF-8"/></p>
<p>UTF-8 has 8-bit code units. It uses 1‚Äì4 code units to encode a code point:</p>
<table class="framed">
  <style>
    th:nth-child(1), td:nth-child(1) {
      text-align: left;
    }
    th:nth-child(2), td:nth-child(2) {
      text-align: left;
    }
  </style>
  <thead>
    <tr>
      <th>Code points</th><th>Code units</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0000‚Äì007F</td><td>0bbbbbbb (7 bits)</td>
    </tr>
    <tr>
      <td>0080‚Äì07FF</td><td>110bbbbb, 10bbbbbb (5+6 bits)</td>
    </tr>
    <tr>
      <td>0800‚ÄìFFFF</td><td>1110bbbb, 10bbbbbb, 10bbbbbb (4+6+6 bits)</td>
    </tr>
    <tr>
      <td>10000‚Äì1FFFFF</td><td>11110bbb, 10bbbbbb, 10bbbbbb, 10bbbbbb (3+6+6+6 bits)</td>
    </tr>
  </tbody>
</table>
<p>Notes:</p>
<ul>
  <li>
    The bit prefix of each code unit tells us:
    <ul>
      <li>
        Is it first in a series of code units? If yes, how many code units will follow?
      </li>
      <li>
        Is it second or later in a series of code units?
      </li>
    </ul>
  </li>
  <li>
    The character mappings in the 0000‚Äì007F range are the same as ASCII, which leads to a degree of backward compatibility with older software.
  </li>
</ul>
<p>Three examples:</p>
<table class="framed">
  <style>
    th:nth-child(1), td:nth-child(1) {
      text-align: left;
    }
    th:nth-child(2), td:nth-child(2) {
      text-align: left;
    }
    th:nth-child(3), td:nth-child(3) {
      text-align: left;
    }
  </style>
  <thead>
    <tr>
      <th>Character</th><th>Code point</th><th>Code units</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>A</td><td>0x0041</td><td>01000001</td>
    </tr>
    <tr>
      <td>œÄ</td><td>0x03C0</td><td>11001111, 10000000</td>
    </tr>
    <tr>
      <td>üôÇ</td><td>0x1F642</td><td>11110000, 10011111, 10011001, 10000010</td>
    </tr>
  </tbody>
</table>
<h3 id="utf-in-web-dev"><a class="heading-id-link" href="#utf-in-web-dev">21.2‚ÄÉEncodings used in web development: UTF-16 and UTF-8</a></h3>
<p>The Unicode encoding formats that are used in web development are: UTF-16 and UTF-8.</p>
<h4 id="source-code-internally-utf16"><a class="heading-id-link" href="#source-code-internally-utf16">21.2.1‚ÄÉSource code internally: UTF-16</a></h4>
<p>The ECMAScript specification internally represents source code as UTF-16.</p>
<h4 id="strings-utf16"><a class="heading-id-link" href="#strings-utf16">21.2.2‚ÄÉStrings: UTF-16</a></h4>
<p>The characters in JavaScript strings are based on UTF-16 code units:</p>
<pre class="language-node-repl">
<span class="hljs-meta prompt_">&gt;</span> <span class="language-javascript"><span class="hljs-keyword">const</span> smiley = <span class="hljs-string">'üôÇ'</span>;</span>
<span class="hljs-meta prompt_">&gt;</span> <span class="language-javascript">smiley.<span class="hljs-property">length</span></span>
2
<span class="hljs-meta prompt_">&gt;</span> <span class="language-javascript">smiley === <span class="hljs-string">'\uD83D\uDE42'</span> <span class="hljs-comment">// code units</span></span>
true
</pre>
<p>For more information on Unicode and strings, see <a href="ch_strings.html#atoms-of-text">‚ÄúAtoms of text: code points, JavaScript characters, grapheme clusters‚Äù (¬ß22.7)</a>.</p>
<h4 id="source-code-in-files-utf8"><a class="heading-id-link" href="#source-code-in-files-utf8">21.2.3‚ÄÉSource code in files: UTF-8</a></h4>
<p>HTML and JavaScript files are almost always encoded as UTF-8 now.</p>
<p>For example, this is how HTML files usually start now:</p>
<pre class="language-html">
<span class="hljs-meta">&lt;!doctype <span class="hljs-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span>
¬∑¬∑¬∑
</pre>
<h3 id="grapheme-clusters"><a class="heading-id-link" href="#grapheme-clusters">21.3‚ÄÉGrapheme clusters ‚Äì the real characters</a></h3>
<p><span id="index-entry-grapheme-cluster"/></p>
<p>The concept of a character becomes remarkably complex once we consider the various writing systems of the world. That‚Äôs why there are several different Unicode terms that all mean ‚Äúcharacter‚Äù in some way: <em>code point</em>, <em>grapheme cluster</em>, <em>glyph</em>, etc.</p>
<p>In Unicode, a <em>code point</em> is an atomic part of text stored in a computer.</p>
<p>However, a <em>grapheme cluster</em> corresponds most closely to a symbol displayed on screen or paper. It is defined as ‚Äúa horizontally segmentable unit of text‚Äù. Therefore, <a href="https://unicode.org/reports/tr29/#Grapheme_Cluster_Boundaries">official Unicode documents</a> also call it a <em>user-perceived character</em>. One or more code points are needed to encode a grapheme cluster.</p>
<p>For example, the Devanagari <em>kshi</em> is encoded by 4 code points. We use <code>Array.from()</code> to split the string into an Array with code points:</p>
<blockquote>
  <p><img src="../Images/327b7f8b4b4d9c9c757e133802a9ace0.png" alt="" style="width:154.5px; height:29.5px" data-original-src="https://exploringjs.com/js/book/img/unicode/code-points-devanagari-kshi.png"/></p>
</blockquote>
<p>Many emojis are composed of multiple code points:</p>
<blockquote>
  <p><img src="../Images/a968a426ee730ce9975413b34be1f93a.png" alt="" style="width:126.5px; height:85.5px" data-original-src="https://exploringjs.com/js/book/img/unicode/code-points-emojis.png"/></p>
</blockquote>
<p>Flag emojis are grapheme clusters and composed of two code points ‚Äì for example, the flag of Japan:</p>
<blockquote>
  <p><img src="../Images/0a7ad977809c49e13a21283b6356d9cb.png" width="119" height="29" alt="" data-original-src="https://exploringjs.com/js/book/img/unicode/code-points-flag-of-japan.png"/></p>
</blockquote>
<h4 id="grapheme-clusters-vs-glyphs"><a class="heading-id-link" href="#grapheme-clusters-vs-glyphs">21.3.1‚ÄÉGrapheme clusters vs. glyphs</a></h4>
<p>A symbol is an abstract concept and part of written language:</p>
<ul>
  <li>
    It is represented in computer memory by a <em>grapheme cluster</em> ‚Äì a sequence of one or more code points (numbers).
  </li>
  <li>
    It is drawn on screen via <em>glyphs</em>. A glyph is an image and usually stored in a font. More than one glyph may be used to draw a single symbol ‚Äì for example, the symbol ‚Äú√©‚Äù may be drawn by combining the glyph ‚Äúe‚Äù with the glyph ‚Äú¬¥‚Äù.
  </li>
</ul>
<p>The distinction between a concept and its representation is subtle and can blur when talking about Unicode.</p>
<div class="boxout">
  <p><img src="../Images/38e6ff55e8d602659f3cdb8893e63f62.png" class="boxout-icon" height="24" alt="Icon ‚Äúexternal‚Äù" data-original-src="https://exploringjs.com/js/book/icon/external.svg"/>‚ÄÇ<strong>More information on grapheme clusters</strong></p>
  <div class="boxout-vspace"/>
  <p>For more information, see <a href="https://manishearth.github.io/blog/2017/01/14/stop-ascribing-meaning-to-unicode-code-points/">‚ÄúLet‚Äôs Stop Ascribing Meaning to Code Points‚Äù</a> by Manish Goregaokar.</p>
</div>

    
      
</body>
</html>