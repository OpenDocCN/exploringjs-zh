<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>31 Assertion functions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>31 Assertion functions</h1>
<blockquote>原文：<a href="https://exploringjs.com/ts/book/ch_assertion-functions.html">https://exploringjs.com/ts/book/ch_assertion-functions.html</a></blockquote>

    
        <div id="adbox">
      <div id="adbox-explain">(Ad, please don’t block.)</div>
              
          </div>
    
    
<nav class="local-toc">
  <ol>
    <li>
      <a href="#assertion-functions-in-node-js">31.1 Assertion functions in Node.js</a>
      <ol>
        <li>
          <a href="#assert-cond-for-asserting-conditions">31.1.1 <code>assert(cond)</code> for asserting conditions</a>
        </li>
        <li>
          <a href="#assert-equal-value1-value2-for-asserting-equality">31.1.2 <code>assert.equal(value1, value2)</code> for asserting equality</a>
        </li>
      </ol>
    </li>
    <li>
      <a href="#typescript-s-support-for-assertion-functions">31.2 TypeScript’s support for assertion functions</a>
    </li>
    <li>
      <a href="#asserting-a-boolean-condition-asserts-cond">31.3 Asserting a boolean condition: <code>asserts «cond»</code></a>
      <ol>
        <li>
          <a href="#asserting-type-guards">31.3.1 Asserting type guards</a>
        </li>
      </ol>
    </li>
    <li>
      <a href="#asserting-the-type-of-an-argument-asserts-arg-is-type">31.4 Asserting the type of an argument: <code>asserts «arg» is «type»</code></a>
      <ol>
        <li>
          <a href="#example-assertion-function-assert-equal">31.4.0.1 Example assertion function: <code>assert.equal()</code></a>
        </li>
      </ol>
    </li>
    <li>
      <a href="#alternatives-to-assertion-functions">31.5 Alternatives to assertion functions</a>
      <ol>
        <li>
          <a href="#technique-forced-conversion">31.5.1 Technique: forced conversion</a>
        </li>
        <li>
          <a href="#technique-throwing-an-exception">31.5.2 Technique: throwing an exception</a>
        </li>
      </ol>
    </li>
    <li>
      <a href="#quick-reference-assertion-functions">31.6 Quick reference: assertion functions</a>
      <ol>
        <li>
          <a href="#assertion-signature-asserts-cond">31.6.1 Assertion signature: <code>asserts «cond»</code></a>
        </li>
        <li>
          <a href="#assertion-signature-asserts-arg-is-type">31.6.2 Assertion signature: <code>asserts «arg» is «type»</code></a>
        </li>
      </ol>
    </li>
  </ol>
</nav>
<p>In programming, an assertion function is a function that checks if a condition is true at a particular point in a program and throws an exception if it isn’t. In this chapter, we explore:</p>
<ul>
  <li>
    How assertion functions are used in JavaScript.
  </li>
  <li>
    How TypeScript supports them at the type level.
  </li>
</ul>
<h3 id="assertion-functions-in-node-js"><a class="heading-id-link" href="#assertion-functions-in-node-js">31.1 Assertion functions in Node.js</a></h3>
<p>Node.js has a whole module, <code>'node:assert/strict'</code> with assertion functions. You can check out <a href="https://nodejs.org/api/assert.html">its documentation</a> online. Let’s look at two important examples.</p>
<h4 id="assert-cond-for-asserting-conditions"><a class="heading-id-link" href="#assert-cond-for-asserting-conditions">31.1.1 <code>assert(cond)</code> for asserting conditions</a></h4>
<p>Function <code>assert()</code> lets us assert conditions. I see it as a comment that is written in code and therefore verifiable – e.g.:</p>
<pre class="language-ts">
<code><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> path <span class="hljs-keyword">from</span> <span class="hljs-string">'node:path'</span>;</code>
<code><span class="hljs-keyword">import</span> assert <span class="hljs-keyword">from</span> <span class="hljs-string">'node:assert/strict'</span>;</code>
<code><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">replaceExt</span>(<span class="hljs-params">filePath: <span class="hljs-built_in">string</span>, ext: <span class="hljs-built_in">string</span></span>): <span class="hljs-built_in">string</span> {</code>
<code>  <span class="hljs-title function_">assert</span>(ext.<span class="hljs-title function_">startsWith</span>(<span class="hljs-string">'.'</span>)); <span class="hljs-comment">// (A)</span></code>
<code>  <span class="hljs-keyword">const</span> parsed = path.<span class="hljs-title function_">parse</span>(filePath);</code>
<code>  <span class="hljs-keyword">return</span> path.<span class="hljs-title function_">join</span>(parsed.<span class="hljs-property">dir</span>, parsed.<span class="hljs-property">name</span> + ext);</code>
<code>}</code>
</pre>
<p><code>ext</code> having to start with a dot could be a comment. Instead, we chose to write it as an assertion (line A). If the condition is false, <code>assert()</code> throws an exception. In other words: <code>assert(cond)</code> means “<code>cond</code> must be true”.</p>
<h4 id="assert-equal-value1-value2-for-asserting-equality"><a class="heading-id-link" href="#assert-equal-value1-value2-for-asserting-equality">31.1.2 <code>assert.equal(value1, value2)</code> for asserting equality</a></h4>
<p>The assertion function <code>assert.equal()</code> is mainly used for testing:</p>
<pre class="language-ts">
<code><span class="hljs-keyword">import</span> assert <span class="hljs-keyword">from</span> <span class="hljs-string">'node:assert/strict'</span>;</code>
<code><span class="hljs-keyword">const</span> <span class="hljs-title function_">add</span> = (<span class="hljs-params">x: <span class="hljs-built_in">number</span>, y: <span class="hljs-built_in">number</span></span>) =&gt; x + y;</code>
<code>assert.<span class="hljs-title function_">equal</span>(</code>
<code>  <span class="hljs-title function_">add</span>(<span class="hljs-number">3</span>, <span class="hljs-number">4</span>), <span class="hljs-number">7</span></code>
<code>);</code>
</pre>
<p>If the two arguments of <code>assert.equal()</code> are not equal, it throws an exception.</p>
<h3 id="typescript-s-support-for-assertion-functions"><a class="heading-id-link" href="#typescript-s-support-for-assertion-functions">31.2 TypeScript’s support for assertion functions</a></h3>
<p>TypeScript provides special support for assertion functions. There are two kinds of <em>assertion signatures</em> we can specify as the return types of <code>void</code> functions.</p>
<p>First, we can assert a boolean condition (think <code>assert()</code>):</p>
<pre class="language-ts">
<code><span class="hljs-keyword">function</span> <span class="hljs-title function_">assertCondition</span>(<span class="hljs-params">condition: <span class="hljs-built_in">boolean</span></span>): asserts condition {</code>
<code>  <span class="hljs-comment">// ...</span></code>
<code>}</code>
</pre>
<p>Second, we can assert the type of an argument:</p>
<pre class="language-ts">
<code><span class="hljs-keyword">function</span> <span class="hljs-title function_">assertArgIsMyType</span>(<span class="hljs-params">arg: <span class="hljs-built_in">unknown</span></span>): asserts arg is <span class="hljs-title class_">MyType</span> {</code>
<code>  <span class="hljs-comment">// ...</span></code>
<code>}</code>
</pre>
<p>Next, we’ll examine how calling an assertion function affects the type level.</p>
<h3 id="asserting-a-boolean-condition-asserts-cond"><a class="heading-id-link" href="#asserting-a-boolean-condition-asserts-cond">31.3 Asserting a boolean condition: <code>asserts «cond»</code></a></h3>
<p>This is a re-implementation of Node’s <code>assert()</code> function so that we can also use it in browsers. It asserts a boolean <code>condition</code>:</p>
<pre class="language-ts">
<code><span class="hljs-keyword">function</span> <span class="hljs-title function_">assertTrue</span>(</code>
<code><span class="hljs-params">  condition: <span class="hljs-built_in">boolean</span>, message?: <span class="hljs-built_in">string</span> | <span class="hljs-built_in">Error</span></span></code>
<code>): asserts condition { <span class="hljs-comment">// (A)</span></code>
<code>  <span class="hljs-keyword">if</span> (!condition) {</code>
<code>    <span class="hljs-keyword">if</span> (message <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Error</span>) {</code>
<code>      <span class="hljs-keyword">throw</span> message;</code>
<code>    }</code>
<code>    message ??= <span class="hljs-string">'Assertion failed'</span>;</code>
<code>    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(message); <span class="hljs-comment">// (B)</span></code>
<code>  }</code>
<code>}</code>
</pre>
<p>The assertion signature in line A makes <code>assertTrue</code> an assertion function. We’ll explore the type-level consequences of that in the next subsection. The following design decisions were made:</p>
<ul>
  <li>
    The type of <code>condition</code> is <code>boolean</code> and not <code>unknown</code> because that forces us to avoid truthiness checks.
  </li>
  <li>
    In line B, we also could have used a custom subclass of <code>Error</code>, e.g. one called <code>AssertionError</code>.
  </li>
</ul>
<h4 id="asserting-type-guards"><a class="heading-id-link" href="#asserting-type-guards">31.3.1 Asserting type guards</a></h4>
<p>Using a <a href="ch_type-guards.html#ch_type-guards"><em>type guard</em></a> (a boolean expression exploring the types of values) in a condition narrows types:</p>
<pre class="language-ts">
<code><span class="hljs-keyword">if</span> («typeGuard») {</code>
<code>  <span class="hljs-comment">// One or more types are narrowed</span></code>
<code>}</code>
</pre>
<p>Asserting a type guard has a similar effect:</p>
<pre class="language-ts">
<code><span class="hljs-title function_">assertTrue</span>(«typeGuard»);</code>
<code><span class="hljs-comment">// One or more types are narrowed</span></code>
</pre>
<p>Let’s look at an example:</p>
<pre class="language-ts">
<code><span class="hljs-keyword">function</span> <span class="hljs-title function_">func</span>(<span class="hljs-params">value: <span class="hljs-built_in">unknown</span></span>) {</code>
<code>  <span class="hljs-title function_">assertTrue</span>(value <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Set</span>); <span class="hljs-comment">// (A)</span></code>
<code>  assertType&lt;<span class="hljs-title class_">Set</span>&lt;<span class="hljs-built_in">any</span>&gt;&gt;(value);</code>
<code>}</code>
</pre>
<p><code>value instanceof Set</code> is a type guard and because we asserted it in line A, we narrowed the type of <code>value</code> to <code>Set&lt;any&gt;</code>.</p>
<h3 id="asserting-the-type-of-an-argument-asserts-arg-is-type"><a class="heading-id-link" href="#asserting-the-type-of-an-argument-asserts-arg-is-type">31.4 Asserting the type of an argument: <code>asserts «arg» is «type»</code></a></h3>
<p>The following assertion function narrows the type of its parameter <code>value</code>:</p>
<pre class="language-ts">
<code><span class="hljs-keyword">function</span> <span class="hljs-title function_">assertIsNumber</span>(<span class="hljs-params">value: <span class="hljs-built_in">unknown</span></span>): asserts value is <span class="hljs-built_in">number</span> {</code>
<code>  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> value !== <span class="hljs-string">'number'</span>) {</code>
<code>    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeError</span>();</code>
<code>  }</code>
<code>}</code>
</pre>
<p>Let’s use <code>assertIsNumber()</code>:</p>
<pre class="language-ts">
<code><span class="hljs-keyword">function</span> <span class="hljs-title function_">func</span>(<span class="hljs-params">value: <span class="hljs-built_in">unknown</span></span>) {</code>
<code>  <span class="hljs-title function_">assertIsNumber</span>(value); <span class="hljs-comment">// (A)</span></code>
<code>  assertType&lt;<span class="hljs-built_in">number</span>&gt;(value);</code>
<code>}</code>
</pre>
<p>The assertion in line A narrows the type of <code>value</code> from <code>unknown</code> to <code>number</code>.</p>
<p>Note that <code>assertIsNumber()</code> really narrows:</p>
<pre class="language-ts">
<code><span class="hljs-keyword">function</span> <span class="hljs-title function_">func</span>(<span class="hljs-params">str: <span class="hljs-built_in">string</span></span>) {</code>
<code>  <span class="hljs-title function_">assertIsNumber</span>(str);</code>
<code>  <span class="hljs-comment">// string &amp; number is `never`</span></code>
<code>  assertType&lt;<span class="hljs-built_in">string</span> &amp; <span class="hljs-built_in">number</span>&gt;(str);</code>
<code>}</code>
</pre>
<p>We narrowed the original type of <code>str</code>, <code>string</code> to the narrower type <code>string &amp; number</code> – which is the same as <a href="ch_never.html#ch_never">the bottom type <code>never</code></a>.</p>
<h5 id="example-assertion-function-assert-equal"><a class="heading-id-link" href="#example-assertion-function-assert-equal">31.4.0.1 Example assertion function: <code>assert.equal()</code></a></h5>
<p>This is a simplified version of Node’s <code>assert.equal()</code> function that has the same types:</p>
<pre class="language-ts">
<code><span class="hljs-keyword">function</span> assertEqual&lt;T&gt;(</code>
<code>  <span class="hljs-attr">actual</span>: <span class="hljs-built_in">unknown</span>, <span class="hljs-attr">expected</span>: T, message?: <span class="hljs-built_in">string</span> | <span class="hljs-title class_">Error</span></code>
<code>): asserts actual is T {</code>
<code>  <span class="hljs-keyword">if</span> (actual !== expected) {</code>
<code>    <span class="hljs-keyword">if</span> (message <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Error</span>) {</code>
<code>      <span class="hljs-keyword">throw</span> message;</code>
<code>    }</code>
<code>    message ??= <span class="hljs-string">`Assertion failed: <span class="hljs-subst">${actual}</span> === <span class="hljs-subst">${expected}</span>`</span>;</code>
<code>    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(message);</code>
<code>  }</code>
<code>}</code>
</pre>
<p>If it terminates, the type of <code>actual</code> is narrowed to the type <code>T</code>. That’s rarely useful, but I found it interesting that the function does that.</p>
<h5 id="example-assertion-function-assertnonnullable"><a class="heading-id-link" href="#example-assertion-function-assertnonnullable">31.4.0.2 Example assertion function: <code>assertNonNullable()</code></a></h5>
<p>The following assertion function asserts that its parameter <code>value</code> is not nullable:</p>
<pre class="language-ts">
<code><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> assertNonNullable&lt;T&gt;(</code>
<code>  <span class="hljs-attr">value</span>: T, message?: <span class="hljs-built_in">string</span></code>
<code>): asserts value is <span class="hljs-title class_">NonNullable</span>&lt;T&gt; {</code>
<code>  <span class="hljs-keyword">if</span> (value === <span class="hljs-literal">undefined</span> || value === <span class="hljs-literal">null</span>) {</code>
<code>    message ??= <span class="hljs-string">'Value must not be undefined or null'</span>;</code>
<code>    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeError</span>(message);</code>
<code>  }</code>
<code>}</code>
</pre>
<p>We use <a href="ch_intersections-object-types.html#NonNullable">the utility type <code>NonNullable&lt;T&gt;</code></a> to remove <code>undefined</code> and <code>null</code> from <code>T</code> – e.g.:</p>
<pre class="language-ts">
<code><span class="hljs-keyword">function</span> <span class="hljs-title function_">getValue</span>(<span class="hljs-params">map: <span class="hljs-built_in">Map</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">number</span>&gt;, key: <span class="hljs-built_in">string</span></span>): <span class="hljs-built_in">number</span> {</code>
<code>  <span class="hljs-keyword">const</span> value = map.<span class="hljs-title function_">get</span>(key);</code>
<code>  assertType&lt;<span class="hljs-literal">undefined</span> | <span class="hljs-built_in">number</span>&gt;(value);</code>
<code>  <span class="hljs-title function_">assertNonNullable</span>(value);</code>
<code>  assertType&lt;<span class="hljs-built_in">number</span>&gt;(value);</code>
<code>  <span class="hljs-keyword">return</span> value;</code>
<code>}</code>
</pre>
<h5 id="example-assertion-function-adding-a-property-to-an-object"><a class="heading-id-link" href="#example-assertion-function-adding-a-property-to-an-object">31.4.0.3 Example assertion function: adding a property to an object</a></h5>
<p>The following assertion function adds a property to an object and updates its type accordingly:</p>
<pre class="language-ts">
<code><span class="hljs-keyword">function</span> addName&lt;T <span class="hljs-keyword">extends</span> <span class="hljs-built_in">object</span>&gt;(<span class="hljs-attr">obj</span>: T, <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>)</code>
<code>: asserts obj is (T &amp; <span class="hljs-title class_">HasName</span>) { <span class="hljs-comment">// (A)</span></code>
<code>  (obj <span class="hljs-keyword">as</span> <span class="hljs-title class_">HasName</span>).<span class="hljs-property">name</span> = name;</code>
<code>}</code>
<code><span class="hljs-keyword">type</span> <span class="hljs-title class_">HasName</span> = {</code>
<code>  <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>,</code>
<code>};</code>
<code/>
<code><span class="hljs-keyword">const</span> point = { <span class="hljs-attr">x</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">0</span> };</code>
<code><span class="hljs-title function_">addName</span>(point, <span class="hljs-string">'zero'</span>);</code>
<code>assertType&lt;{ <span class="hljs-attr">x</span>: <span class="hljs-built_in">number</span>, <span class="hljs-attr">y</span>: <span class="hljs-built_in">number</span>, <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span> }&gt;(point);</code>
</pre>
<p>An intersection type <code>S &amp; T</code> (such as the one in line A) has the properties of both type <code>S</code> and type <code>T</code>.</p>
<h3 id="alternatives-to-assertion-functions"><a class="heading-id-link" href="#alternatives-to-assertion-functions">31.5 Alternatives to assertion functions</a></h3>
<h4 id="technique-forced-conversion"><a class="heading-id-link" href="#technique-forced-conversion">31.5.1 Technique: forced conversion</a></h4>
<p>An assertion function narrows the type of an existing value. A forced conversion function returns an existing value with a new type – for example:</p>
<pre class="language-ts">
<code><span class="hljs-keyword">function</span> <span class="hljs-title function_">forceNumber</span>(<span class="hljs-params">value: <span class="hljs-built_in">unknown</span></span>): <span class="hljs-built_in">number</span> {</code>
<code>  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> value !== <span class="hljs-string">'number'</span>) {</code>
<code>    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeError</span>();</code>
<code>  }</code>
<code>  <span class="hljs-keyword">return</span> value;</code>
<code>}</code>
<code/>
<code><span class="hljs-keyword">const</span> <span class="hljs-attr">value1a</span>: <span class="hljs-built_in">unknown</span> = <span class="hljs-number">123</span>;</code>
<code><span class="hljs-keyword">const</span> value1b = <span class="hljs-title function_">forceNumber</span>(value1a);</code>
<code>assertType&lt;<span class="hljs-built_in">number</span>&gt;(value1b);</code>
<code/>
<code><span class="hljs-keyword">const</span> <span class="hljs-attr">value2</span>: <span class="hljs-built_in">unknown</span> = <span class="hljs-string">'abc'</span>;</code>
<code>assert.<span class="hljs-title function_">throws</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">forceNumber</span>(value2));</code>
</pre>
<p>The corresponding assertion function looks as follows:</p>
<pre class="language-ts">
<code><span class="hljs-keyword">function</span> <span class="hljs-title function_">assertIsNumber</span>(<span class="hljs-params">value: <span class="hljs-built_in">unknown</span></span>): asserts value is <span class="hljs-built_in">number</span> {</code>
<code>  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> value !== <span class="hljs-string">'number'</span>) {</code>
<code>    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TypeError</span>();</code>
<code>  }</code>
<code>}</code>
<code/>
<code><span class="hljs-keyword">const</span> <span class="hljs-attr">value1</span>: <span class="hljs-built_in">unknown</span> = <span class="hljs-number">123</span>;</code>
<code><span class="hljs-title function_">assertIsNumber</span>(value1);</code>
<code>assertType&lt;<span class="hljs-built_in">number</span>&gt;(value1);</code>
<code/>
<code><span class="hljs-keyword">const</span> <span class="hljs-attr">value2</span>: <span class="hljs-built_in">unknown</span> = <span class="hljs-string">'abc'</span>;</code>
<code>assert.<span class="hljs-title function_">throws</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">assertIsNumber</span>(value2));</code>
</pre>
<p>Forced conversion is a versatile technique with uses beyond those of assertion functions. For example, we can convert:</p>
<ul>
  <li>
    From an input format (think JSON schema) that is easy to write
  </li>
  <li>
    Into an output format that is easy to work with in code.
  </li>
</ul>
<p>For more information, see <a href="ch_validating-external-data.html#external-vs-internal-representation-of-data">“External vs. internal representation of data” (§32.3.4)</a>.</p>
<h4 id="technique-throwing-an-exception"><a class="heading-id-link" href="#technique-throwing-an-exception">31.5.2 Technique: throwing an exception</a></h4>
<p>Consider the following code:</p>
<pre class="language-ts">
<code><span class="hljs-keyword">function</span> <span class="hljs-title function_">getLengthOfValue</span>(<span class="hljs-params">strMap: <span class="hljs-built_in">Map</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">string</span>&gt;, key: <span class="hljs-built_in">string</span></span>)</code>
<code>: <span class="hljs-built_in">number</span> {</code>
<code>  <span class="hljs-keyword">if</span> (strMap.<span class="hljs-title function_">has</span>(key)) {</code>
<code>    <span class="hljs-keyword">const</span> value = strMap.<span class="hljs-title function_">get</span>(key);</code>
<code/>
<code>    assertType&lt;<span class="hljs-built_in">string</span> | <span class="hljs-literal">undefined</span>&gt;(value); <span class="hljs-comment">// before type check</span></code>
<code>    <span class="hljs-comment">// We know that value can’t be `undefined`</span></code>
<code>    <span class="hljs-keyword">if</span> (value === <span class="hljs-literal">undefined</span>) { <span class="hljs-comment">// (A)</span></code>
<code>      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>();</code>
<code>    }</code>
<code>    assertType&lt;<span class="hljs-built_in">string</span>&gt;(value); <span class="hljs-comment">// after type check</span></code>
<code/>
<code>    <span class="hljs-keyword">return</span> value.<span class="hljs-property">length</span>;</code>
<code>  }</code>
<code>  <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;</code>
<code>}</code>
</pre>
<p>Instead of the <code>if</code> statement that starts in line A, we also could have used an assertion function:</p>
<pre class="language-ts">
<code><span class="hljs-title function_">assertNonNullable</span>(value);</code>
</pre>
<p>Throwing an exception is a quick alternative if we don’t want to write such a function. Similarly to calling an assertion function, this technique also updates the static type.</p>
<h3 id="quick-reference-assertion-functions"><a class="heading-id-link" href="#quick-reference-assertion-functions">31.6 Quick reference: assertion functions</a></h3>
<h4 id="assertion-signature-asserts-cond"><a class="heading-id-link" href="#assertion-signature-asserts-cond">31.6.1 Assertion signature: <code>asserts «cond»</code></a></h4>
<pre class="language-ts">
<code><span class="hljs-keyword">function</span> <span class="hljs-title function_">assertTrue</span>(<span class="hljs-params">condition: <span class="hljs-built_in">boolean</span></span>): asserts condition {</code>
<code>  <span class="hljs-keyword">if</span> (!condition) {</code>
<code>    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(); <span class="hljs-comment">// assertion error</span></code>
<code>  }</code>
<code>}</code>
</pre>
<ul>
  <li>
    Assertion signature: <code>asserts condition</code>
  </li>
  <li>
    Result: <code>void</code> or exception
  </li>
</ul>
<h4 id="assertion-signature-asserts-arg-is-type"><a class="heading-id-link" href="#assertion-signature-asserts-arg-is-type">31.6.2 Assertion signature: <code>asserts «arg» is «type»</code></a></h4>
<pre class="language-ts">
<code><span class="hljs-keyword">function</span> <span class="hljs-title function_">assertIsString</span>(<span class="hljs-params">value: <span class="hljs-built_in">unknown</span></span>): asserts value is <span class="hljs-built_in">string</span> {</code>
<code>  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> value !== <span class="hljs-string">'string'</span>) {</code>
<code>    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(); <span class="hljs-comment">// assertion error</span></code>
<code>  }</code>
<code>}</code>
</pre>
<ul>
  <li>
    Assertion signature: <code>asserts value is string</code>
  </li>
  <li>
    Result: <code>void</code> or exception
  </li>
</ul>

    
      
</body>
</html>