- en: 11 Assertion API
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://exploringjs.com/js/book/ch_assertion-api.html](https://exploringjs.com/js/book/ch_assertion-api.html)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '[11.1 Assertions in software development](#assertions-in-software-development)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[11.2 How assertions are used in this book](#how-assertions-are-used-in-this-book)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[11.2.1 Documenting results in code examples via assertions](#documenting-results-in-code-examples-via-assertions)'
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: '[11.2.2 Implementing test-driven exercises via assertions](#implementing-testdriven-exercises-via-assertions)'
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: '[11.3 Normal comparison vs. deep comparison](#normal-comparison-vs-deep-comparison)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[11.4 Quick reference: module `assert`](#quick-reference-module-assert)'
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
- en: '[11.4.1 Normal equality: `assert.equal()`](#normal-equality-assertequal)'
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: '[11.4.2 Deep equality: `assert.deepEqual()`](#deep-equality-assertdeepequal)'
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: '[11.4.3 Expecting exceptions: `assert.throws()`](#assert.throws)'
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: '[11.4.4 Always fail: `assert.fail()`](#always-fail-assertfail)'
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
- en: '[11.1 Assertions in software development](#assertions-in-software-development)'
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'In software development, *assertions* state facts about values or pieces of
    code that must be true. If they aren’t, an exception is thrown. Node.js supports
    assertions via its built-in module `assert` – for example:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: This assertion states that the expected result of 3 plus 5 is 8\. The import
    statement uses [the recommended `strict` version](https://nodejs.org/api/assert.html#assert_strict_mode)
    of `assert`.
  prefs: []
  type: TYPE_NORMAL
- en: '[11.2 How assertions are used in this book](#how-assertions-are-used-in-this-book)'
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'In this book, assertions are used in two ways: to document results in code
    examples and to implement test-driven exercises.'
  prefs: []
  type: TYPE_NORMAL
- en: '[11.2.1 Documenting results in code examples via assertions](#documenting-results-in-code-examples-via-assertions)'
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'In code examples, assertions express expected results. Take, for example, the
    following function:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: '`id()` returns its parameter. We can show it in action via an assertion:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: In the examples, I usually omit the statement for importing `assert`.
  prefs: []
  type: TYPE_NORMAL
- en: 'The motivation behind using assertions is:'
  prefs: []
  type: TYPE_NORMAL
- en: We can specify precisely what is expected.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Code examples can be tested automatically, which ensures that they really work.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '[11.2.2 Implementing test-driven exercises via assertions](#implementing-testdriven-exercises-via-assertions)'
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: The exercises for this book are test-driven, via the test framework Mocha. Checks
    inside the tests are made via methods of `assert`.
  prefs: []
  type: TYPE_NORMAL
- en: 'The following is an example of such a test:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: For more information, see [“Getting started with exercises” (§12)](ch_exercises.html#ch_exercises).
  prefs: []
  type: TYPE_NORMAL
- en: '[11.3 Normal comparison vs. deep comparison](#normal-comparison-vs-deep-comparison)'
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 'The strict `equal()` uses `===` to compare values. Therefore, an object is
    only equal to itself – even if another object has the same content (because `===`
    does not compare the contents of objects, only their identities):'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: '`deepEqual()` is a better choice for comparing objects:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: 'This method works for Arrays, too:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: '[11.4 Quick reference: module `assert`](#quick-reference-module-assert)'
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: For the full documentation, see [the Node.js docs](https://nodejs.org/api/assert.html).
  prefs: []
  type: TYPE_NORMAL
- en: '[11.4.1 Normal equality: `assert.equal()`](#normal-equality-assertequal)'
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: '`assert.equal(actual, expected, message?)`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`actual === expected` must be `true`. If not, an `AssertionError` is thrown.'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: '`assert.notEqual(actual, expected, message?)`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`actual !== expected` must be `true`. If not, an `AssertionError` is thrown.'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '[PRE8]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: The optional last parameter `message` can be used to explain what is asserted.
    If the assertion fails, the message is used to set up the `AssertionError` that
    is thrown.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE9]'
  prefs: []
  type: TYPE_PRE
- en: '[11.4.2 Deep equality: `assert.deepEqual()`](#deep-equality-assertdeepequal)'
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: '`assert.deepEqual(actual, expected, message?)`'
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: '`actual` must be deeply equal to `expected`. If not, an `AssertionError` is
    thrown.'
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
- en: '[PRE10]'
  prefs:
  - PREF_IND
  type: TYPE_PRE
- en: '[PRE11]     assert.notDeepEqual([1,2,3], [1,2]);          [PRE12]`'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE13]     assert.throws(      () => {      null.prop;      }     );          [PRE14]     assert.throws(      ()
    => {      null.prop;      },      TypeError     );          [PRE15]     assert.throws(      ()
    => {      null.prop;      },      /^TypeError: Cannot read properties of null
    \(reading ''prop''\)$/     );          [PRE16]     assert.throws(      () => {      null.prop;      },      {      name:
    ''TypeError'',      message: "Cannot read properties of null (reading ''prop'')",      }     );          [PRE17]     try
    {      functionThatShouldThrow();      assert.fail();     } catch (_) {      //
    Success     }          [PRE18]`'
  prefs: []
  type: TYPE_NORMAL
