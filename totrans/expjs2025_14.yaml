- en: 12 Getting started with exercises
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 12   开始使用练习
- en: 原文：[https://exploringjs.com/js/book/ch_exercises.html](https://exploringjs.com/js/book/ch_exercises.html)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: '[原文](https://exploringjs.com/js/book/ch_exercises.html)'
- en: '[12.1 Exercises](#exercises)'
  id: totrans-2
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '[12.1   练习](#exercises)'
- en: '[12.1.1 Installing the exercises](#installing-the-exercises)'
  id: totrans-3
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: '[12.1.1   安装练习](#installing-the-exercises)'
- en: '[12.1.2 Running exercises](#running-exercises)'
  id: totrans-4
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: '[12.1.2   运行练习](#running-exercises)'
- en: '[12.2 Unit tests in JavaScript](#unit-tests-in-javascript)'
  id: totrans-5
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '[12.2   JavaScript 中的单元测试](#unit-tests-in-javascript)'
- en: '[12.2.1 A typical test](#a-typical-test)'
  id: totrans-6
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: '[12.2.1   典型测试](#a-typical-test)'
- en: '[12.2.2 Asynchronous tests in Mocha](#async-tests-mocha)'
  id: totrans-7
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: '[12.2.2   Mocha 中的异步测试](#async-tests-mocha)'
- en: Throughout most chapters, there are boxes that point to exercises. These are
    a paid feature, but a comprehensive preview is available. This chapter explains
    how to get started with them.
  id: totrans-8
  prefs: []
  type: TYPE_NORMAL
  zh: 在大多数章节中，都有指向练习的框。这些是付费功能，但提供了全面的预览。本章解释了如何开始使用它们。
- en: '[12.1 Exercises](#exercises)'
  id: totrans-9
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '[12.1   练习](#exercises)'
- en: '[12.1.1 Installing the exercises](#installing-the-exercises)'
  id: totrans-10
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '[12.1.1   安装练习](#installing-the-exercises)'
- en: 'To install the exercises:'
  id: totrans-11
  prefs: []
  type: TYPE_NORMAL
  zh: 要安装练习：
- en: Download and unzip `exploring-js-code.zip`
  id: totrans-12
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 下载并解压 `exploring-js-code.zip`
- en: Follow the instructions in `README.txt`
  id: totrans-13
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 按照以下 `README.txt` 中的说明操作。
- en: '[12.1.2 Running exercises](#running-exercises)'
  id: totrans-14
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '[12.1.2   运行练习](#running-exercises)'
- en: Exercises are referred to by path in this book.
  id: totrans-15
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 本书中的练习通过路径引用。
- en: 'For example: `exercises/exercises/first_module_test.mjs`'
  id: totrans-16
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 例如：`exercises/exercises/first_module_test.mjs`
- en: 'Within each file:'
  id: totrans-17
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 在每个文件中：
- en: The first line contains the command for running the exercise.
  id: totrans-18
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 第一行包含运行练习的命令。
- en: The following lines describe what you have to do.
  id: totrans-19
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 以下行描述了您必须执行的操作。
- en: '[12.2 Unit tests in JavaScript](#unit-tests-in-javascript)'
  id: totrans-20
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '[12.2   JavaScript 中的单元测试](#unit-tests-in-javascript)'
- en: All exercises in this book are tests that are run via the test framework [Mocha](https://mochajs.org).
    This section gives a brief introduction.
  id: totrans-21
  prefs: []
  type: TYPE_NORMAL
  zh: 本书中的所有练习都是通过测试框架 [Mocha](https://mochajs.org) 运行的测试。本节提供了简要介绍。
- en: '[12.2.1 A typical test](#a-typical-test)'
  id: totrans-22
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '[12.2.1   典型测试](#a-typical-test)'
- en: 'Typical test code is split into two parts:'
  id: totrans-23
  prefs: []
  type: TYPE_NORMAL
  zh: 典型的测试代码分为两部分：
- en: 'Part 1: the code to be tested.'
  id: totrans-24
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 第 1 部分：待测试的代码。
- en: 'Part 2: the tests for the code.'
  id: totrans-25
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 第 2 部分：代码的测试。
- en: 'Take, for example, the following two files:'
  id: totrans-26
  prefs: []
  type: TYPE_NORMAL
  zh: 以以下两个文件为例：
- en: '`id.mjs` (code to be tested)'
  id: totrans-27
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`id.mjs` (待测试的代码)'
- en: '`id_test.mjs` (tests)'
  id: totrans-28
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`id_test.mjs` (测试)'
- en: '[12.2.1.1 Part 1: the code](#part-1-the-code)'
  id: totrans-29
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '[12.2.1.1   第 1 部分：代码](#part-1-the-code)'
- en: 'The code itself resides in `id.mjs`:'
  id: totrans-30
  prefs: []
  type: TYPE_NORMAL
  zh: 代码本身位于 `id.mjs`：
- en: '[PRE0]'
  id: totrans-31
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'The key thing here is: everything we want to test must be exported. Otherwise,
    the test code can’t access it.'
  id: totrans-32
  prefs: []
  type: TYPE_NORMAL
  zh: 这里关键的是：我们想要测试的所有内容都必须导出。否则，测试代码无法访问它。
- en: '[12.2.1.2 Part 2: the tests](#part-2-the-tests)'
  id: totrans-33
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '[12.2.1.2   第 2 部分：测试](#part-2-the-tests)'
- en: '![Icon “reading”](../Images/0fb62b2fc33a72829ae9fb174dedd0d2.png) **Don’t worry
    about the exact details of tests**'
  id: totrans-34
  prefs: []
  type: TYPE_NORMAL
  zh: '![阅读图标](../Images/0fb62b2fc33a72829ae9fb174dedd0d2.png) **不要担心测试的详细细节**'
- en: 'You don’t need to worry about the exact details of tests: They are always implemented
    for you. Therefore, you only need to read them, but not write them.'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 您不需要担心测试的详细细节：它们总是为您实现。因此，您只需要阅读它们，而不需要编写它们。
- en: 'The tests for the code reside in `id_test.mjs`:'
  id: totrans-36
  prefs: []
  type: TYPE_NORMAL
  zh: 代码的测试位于 `id_test.mjs`：
- en: '[PRE1]'
  id: totrans-37
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: What’s inside this file?
  id: totrans-38
  prefs: []
  type: TYPE_NORMAL
  zh: 这个文件里有什么？
- en: It starts with the command for running the test.
  id: totrans-39
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 它以运行测试的命令开始。
- en: Next are instructions for how to implement the solution.
  id: totrans-40
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 接下来是实施解决方案的说明。
- en: '`suite()` provides a title for the tests in this file.'
  id: totrans-41
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`suite()` 为此文件中的测试提供标题。'
- en: We use the Node.js `assert` module in *strict* mode.
  id: totrans-42
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们在严格模式下使用 Node.js 的 `assert` 模块。
- en: Function `test()` defines named test cases.
  id: totrans-43
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 函数 `test()` 定义了命名的测试用例。
- en: The core of the test is `assert.equal()` checking the result of the imported
    function `id()`. That’s the function we have to implement.
  id: totrans-44
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 测试的核心是 `assert.equal()` 检查导入的函数 `id()` 的结果。这就是我们必须实现的函数。
- en: 'To run the test, we execute the following command in a shell:'
  id: totrans-45
  prefs: []
  type: TYPE_NORMAL
  zh: 要运行测试，我们在 shell 中执行以下命令：
- en: '[PRE2]'
  id: totrans-46
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: 'The `t` is an abbreviation for `test`. That is, the long version of this command
    is:'
  id: totrans-47
  prefs: []
  type: TYPE_NORMAL
  zh: '`t` 是 `test` 的缩写。也就是说，这个命令的完整版本是：'
- en: '[PRE3]'
  id: totrans-48
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: '![Icon “exercise”](../Images/4fc2ec98bb44cc1f4de7c6a46d9dd043.png) **Exercise:
    Your first exercise**'
  id: totrans-49
  prefs: []
  type: TYPE_NORMAL
  zh: '![练习图标](../Images/4fc2ec98bb44cc1f4de7c6a46d9dd043.png) **练习：您的第一个练习**'
- en: 'The following exercise gives you a first taste of what exercises are like:'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 以下练习让您首次体验练习的样子：
- en: '`exercises/exercises/first_module_test.mjs`'
  id: totrans-51
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`exercises/exercises/first_module_test.mjs`'
- en: '[12.2.2 Asynchronous tests in Mocha](#async-tests-mocha)'
  id: totrans-52
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '[12.2.2   Mocha 中的异步测试](#async-tests-mocha)'
- en: '![Icon “reading”](../Images/0fb62b2fc33a72829ae9fb174dedd0d2.png) **Reading**'
  id: totrans-53
  prefs: []
  type: TYPE_NORMAL
  zh: '![Icon “reading”](../Images/0fb62b2fc33a72829ae9fb174dedd0d2.png) **阅读**'
- en: You may want to postpone reading this section until you get to the chapters
    on asynchronous programming.
  id: totrans-54
  prefs: []
  type: TYPE_NORMAL
  zh: 你可能想等到你读到关于异步编程的章节后再阅读这一节。
- en: 'Writing tests for asynchronous code requires extra work: The test receives
    its results later and has to signal to Mocha that it isn’t finished yet when it
    returns. The following subsections examine three ways of doing so.'
  id: totrans-55
  prefs: []
  type: TYPE_NORMAL
  zh: 为异步代码编写测试需要额外的工作：测试结果会在之后收到，并且当它返回时必须向 Mocha 信号表示它尚未完成。以下小节将探讨三种实现此功能的方法。
- en: '[12.2.2.1 Asynchronicity via callbacks](#asynchronicity-via-callbacks)'
  id: totrans-56
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '[12.2.2.1 通过回调实现异步](#asynchronicity-via-callbacks)'
- en: 'If the callback we pass to `test()` has a parameter (e.g., `done`), Mocha switches
    to callback-based asynchronicity. When we are done with our asynchronous work,
    we have to call `done`:'
  id: totrans-57
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们传递给 `test()` 的回调函数有一个参数（例如，`done`），Mocha 将切换到基于回调的异步。当我们完成我们的异步工作时，我们必须调用
    `done`：
- en: '[PRE4]'
  id: totrans-58
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: 'This is what `divideCallback()` looks like:'
  id: totrans-59
  prefs: []
  type: TYPE_NORMAL
  zh: 这就是 `divideCallback()` 的样子：
- en: '[PRE5]'
  id: totrans-60
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: '[12.2.2.2 Asynchronicity via Promises](#asynchronicity-via-promises)'
  id: totrans-61
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '[12.2.2.2 通过 Promises 实现异步](#asynchronicity-via-promises)'
- en: If a test returns a Promise, Mocha switches to Promise-based asynchronicity.
    A test is considered successful if the Promise is fulfilled and failed if the
    Promise is rejected or if a settlement takes longer than a timeout.
  id: totrans-62
  prefs: []
  type: TYPE_NORMAL
  zh: 如果测试返回一个 Promise，Mocha 将切换到基于 Promise 的异步。如果 Promise 被满足，则测试被认为是成功的；如果 Promise
    被拒绝，或者解决时间超过超时，则测试被认为是失败的。
- en: '[PRE6]'
  id: totrans-63
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: '`dividePromise()` is implemented as follows:'
  id: totrans-64
  prefs: []
  type: TYPE_NORMAL
  zh: '`dividePromise()` 的实现如下：'
- en: '[PRE7]'
  id: totrans-65
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: '[12.2.2.3 Async functions as test “bodies”](#async-functions-as-test-bodies)'
  id: totrans-66
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '[12.2.2.3 异步函数作为测试“主体”](#async-functions-as-test-bodies)'
- en: Async functions always return Promises. Therefore, an async function is a convenient
    way of implementing an asynchronous test. The following code is equivalent to
    the previous example.
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 异步函数总是返回 Promises。因此，异步函数是实现异步测试的一种便捷方式。以下代码与上一个示例等价。
- en: '[PRE8]'
  id: totrans-68
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'We don’t need to explicitly return anything: The implicitly returned `undefined`
    is used to fulfill the Promise returned by this async function. And if the test
    code throws an exception, then the async function takes care of rejecting the
    returned Promise.'
  id: totrans-69
  prefs: []
  type: TYPE_NORMAL
  zh: 我们不需要显式地返回任何内容：隐式返回的 `undefined` 用于满足此异步函数返回的 Promise。如果测试代码抛出异常，则异步函数会负责拒绝返回的
    Promise。
