- en: 21 Type assertions (related to casting)
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
- en: 原文：[https://exploringjs.com/tackling-ts/ch_type-assertions.html](https://exploringjs.com/tackling-ts/ch_type-assertions.html)
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: 21.1 [Type assertions](ch_type-assertions.html#type-assertions)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 21.1.1 [Alternative syntax for type assertions](ch_type-assertions.html#alternative-syntax-for-type-assertions)
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '21.1.2 [Example: asserting an interface](ch_type-assertions.html#example-asserting-an-interface)'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '21.1.3 [Example: asserting an index signature](ch_type-assertions.html#example-asserting-an-index-signature)'
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: 21.2 [Constructs related to type assertions](ch_type-assertions.html#constructs-related-to-type-assertions)
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: 21.2.1 [Non-nullish assertion operator (postfix `!`)](ch_type-assertions.html#non-nullish-assertion-operator-postfix)
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: 21.2.2 [Definite assignment assertions](ch_type-assertions.html#definite-assignment-assertions)
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
- en: '* * *'
  prefs: []
  type: TYPE_NORMAL
- en: This chapter is about *type assertions* in TypeScript, which are related to
    type casts in other languages and performed via the `as` operator.
  prefs: []
  type: TYPE_NORMAL
- en: 21.1 Type assertions
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: A type assertion lets us override a static type that TypeScript has computed
    for a value. That is useful for working around limitations of the type system.
  prefs: []
  type: TYPE_NORMAL
- en: Type assertions are related to type casts in other languages, but they don’t
    throw exceptions and don’t do anything at runtime (they do perform a few minimal
    checks statically).
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE0]'
  prefs: []
  type: TYPE_PRE
- en: 'Comments:'
  prefs: []
  type: TYPE_NORMAL
- en: In line A, we widen the type of the Array to `object`.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: In line B, we see that this type doesn’t let us access any properties ([details](https://2ality.com/2020/01/typing-objects-typescript.html#object-%28lowercase-“o”%29-in-typescript%3A-non-primitive-values)).
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: In line C, we use a type assertion (the operator `as`) to tell TypeScript that
    `data` is an Array. Now we can access property `.length`.
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
- en: Type assertions are a last resort and should be avoided as much as possible.
    They (temporarily) remove the safety net that the static type system normally
    gives us.
  prefs: []
  type: TYPE_NORMAL
- en: 'Note that, in line A, we also overrode TypeScript’s static type. But we did
    it via a type annotation. This way of overriding is much safer than type assertions
    because we are much more constrained: TypeScript’s type must be assignable to
    the type of the annotation.'
  prefs: []
  type: TYPE_NORMAL
- en: 21.1.1 Alternative syntax for type assertions
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'TypeScript has an alternative “angle-bracket” syntax for type assertions:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE1]'
  prefs: []
  type: TYPE_PRE
- en: I recommend avoiding this syntax. It has grown out of style and is not compatible
    with React JSX code (in `.tsx` files).
  prefs: []
  type: TYPE_NORMAL
- en: '21.1.2 Example: asserting an interface'
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: In order to access property `.name` of an arbitrary object `obj`, we temporarily
    change the static type of `obj` to `Named` (line A and line B).
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE2]'
  prefs: []
  type: TYPE_PRE
- en: '21.1.3 Example: asserting an index signature'
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: In the following code (line A), we use the type assertion `as Dict`, so that
    we can access the properties of a value whose inferred type is `object`. That
    is, we are overriding the static type `object` with the static type `Dict`.
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE3]'
  prefs: []
  type: TYPE_PRE
- en: 21.2 Constructs related to type assertions
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
- en: 21.2.1 Non-nullish assertion operator (postfix `!`)
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: 'If a value’s type is a union that includes the types `undefined` or `null`,
    the *non-nullish assertion operator* (or *non-null assertion operator*) removes
    these types from the union. We are telling TypeScript: “This value can’t be `undefined`
    or `null`.” As a consequence, we can perform operations that are prevented by
    the types of these two values – for example:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE4]'
  prefs: []
  type: TYPE_PRE
- en: '21.2.1.1 Example – Maps: `.get()` after `.has()`'
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
- en: 'After we use the Map method `.has()`, we know that a Map has a given key. Alas,
    the result of `.get()` does not reflect that knowledge, which is why we have to
    use the nullish assertion operator:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE5]'
  prefs: []
  type: TYPE_PRE
- en: 'We can avoid the nullish assertion operator whenever the values of a Map can’t
    be `undefined`. Then missing entries can be detected by checking if the result
    of `.get()` is `undefined`:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE6]'
  prefs: []
  type: TYPE_PRE
- en: 21.2.2 Definite assignment assertions
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
- en: If [*strict property initialization*](https://www.typescriptlang.org/docs/handbook/release-notes/typescript-2-7.html#strict-class-initialization)
    is switched on, we occasionally need to tell TypeScript that we do initialize
    certain properties – even though it thinks we don’t.
  prefs: []
  type: TYPE_NORMAL
- en: 'This is an example where TypeScript complains even though it shouldn’t:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE7]'
  prefs: []
  type: TYPE_PRE
- en: 'The errors go away if we use *definite assignment assertions* (exclamation
    marks) in line A and line B:'
  prefs: []
  type: TYPE_NORMAL
- en: '[PRE8]'
  prefs: []
  type: TYPE_PRE
- en: '[Comments](https://github.com/rauschma/tackling-ts/issues/22)'
  prefs: []
  type: TYPE_NORMAL
