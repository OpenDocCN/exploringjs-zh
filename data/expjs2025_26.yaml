- en: 22 Strings
  id: totrans-0
  prefs:
  - PREF_H1
  type: TYPE_NORMAL
  zh: 22 字符串
- en: 原文：[https://exploringjs.com/js/book/ch_strings.html](https://exploringjs.com/js/book/ch_strings.html)
  id: totrans-1
  prefs:
  - PREF_BQ
  type: TYPE_NORMAL
  zh: 原文：[https://exploringjs.com/js/book/ch_strings.html](https://exploringjs.com/js/book/ch_strings.html)
- en: '[22.1 Cheat sheet: strings](#cheat-sheet-strings)'
  id: totrans-2
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '[22.1 速查表：字符串](#cheat-sheet-strings)'
- en: '[22.1.1 Working with strings](#working-with-strings)'
  id: totrans-3
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: '[22.1.1 处理字符串](#working-with-strings)'
- en: '[22.1.2 JavaScript characters vs. code points vs. grapheme clusters](#javascript-characters-vs-code-points-vs-grapheme-clusters)'
  id: totrans-4
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: '[22.1.2 JavaScript 字符与码点与图形簇](#javascript-characters-vs-code-points-vs-grapheme-clusters)'
- en: '[22.1.3 String methods](#string-methods)'
  id: totrans-5
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: '[22.1.3 字符串方法](#string-methods)'
- en: '[22.2 Plain string literals](#plain-string-literals)'
  id: totrans-6
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '[22.2 普通字符串字面量](#plain-string-literals)'
- en: '[22.2.1 Escaping](#escaping)'
  id: totrans-7
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: '[22.2.1 转义](#escaping)'
- en: '[22.3 Accessing JavaScript characters](#accessing-javascript-characters)'
  id: totrans-8
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '[22.3 访问 JavaScript 字符](#accessing-javascript-characters)'
- en: '[22.4 String concatenation](#string-concatenation)'
  id: totrans-9
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '[22.4 字符串连接](#string-concatenation)'
- en: '[22.4.1 String concatenation via `+`](#string-concatenation-via-plus)'
  id: totrans-10
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: '[22.4.1 通过 `+` 进行字符串连接](#string-concatenation-via-plus)'
- en: '[22.4.2 Concatenating via Arrays (`.push()` and `.join()`)](#string-concatenation-via-arrays)'
  id: totrans-11
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: '[22.4.2 通过数组连接（`.push()` 和 `.join()`）](#string-concatenation-via-arrays)'
- en: '[22.5 Converting values to strings in JavaScript has pitfalls](#converting-values-to-strings)'
  id: totrans-12
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '[22.5 在 JavaScript 中将值转换为字符串有陷阱](#converting-values-to-strings)'
- en: '[22.5.1 Example: code that is problematic](#example-code-that-is-problematic)'
  id: totrans-13
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: '[22.5.1 示例：有问题的代码](#example-code-that-is-problematic)'
- en: '[22.5.2 Four common ways of converting values to strings](#four-common-ways-of-converting-values-to-strings)'
  id: totrans-14
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: '[22.5.2 四种常见的将值转换为字符串的方法](#four-common-ways-of-converting-values-to-strings)'
- en: '[22.5.3 Using `JSON.stringify()` to convert values to strings](#using-jsonstringify-to-convert-values-to-strings)'
  id: totrans-15
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: '[22.5.3 使用 `JSON.stringify()` 将值转换为字符串](#using-jsonstringify-to-convert-values-to-strings)'
- en: '[22.5.4 Solutions](#solutions)'
  id: totrans-16
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: '[22.5.4 解决方案](#solutions)'
- en: '[22.5.5 Customizing how objects are converted to strings](#customizing-how-objects-are-converted-to-strings)'
  id: totrans-17
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: '[22.5.5 自定义对象转换为字符串的方式](#customizing-how-objects-are-converted-to-strings)'
- en: '[22.6 Comparing strings](#comparing-strings)'
  id: totrans-18
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '[22.6 比较字符串](#comparing-strings)'
- en: '[22.7 Atoms of text: code points, JavaScript characters, grapheme clusters](#atoms-of-text)'
  id: totrans-19
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '[22.7 文本原子：码点、JavaScript 字符、图形簇](#atoms-of-text)'
- en: '[22.7.1 Working with code units (JavaScript characters)](#working-with-code-units-javascript-characters)'
  id: totrans-20
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: '[22.7.1 处理代码单元（JavaScript 字符）](#working-with-code-units-javascript-characters)'
- en: '[22.7.2 Working with code points](#working-with-code-points)'
  id: totrans-21
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: '[22.7.2 处理码点](#working-with-code-points)'
- en: '[22.7.3 Working with grapheme clusters](#working-with-grapheme-clusters)'
  id: totrans-22
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: '[22.7.3 处理图形簇](#working-with-grapheme-clusters)'
- en: '[22.8 Quick reference: Strings](#quickref-string)'
  id: totrans-23
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '[22.8 快速参考：字符串](#quickref-string)'
- en: '[22.8.1 Converting to string](#converting-to-string)'
  id: totrans-24
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: '[22.8.1 转换为字符串](#converting-to-string)'
- en: '[22.8.2 Numeric values of text atoms](#numeric-values-of-text-atoms)'
  id: totrans-25
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: '[22.8.2 文本原子的数值](#numeric-values-of-text-atoms)'
- en: '[22.8.3 `String.prototype.*`: regular expression methods](#stringprototype-regular-expression-methods)'
  id: totrans-26
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: '[22.8.3 `String.prototype.*`: 正则表达式方法](#stringprototype-regular-expression-methods)'
- en: '[22.8.4 `String.prototype.*`: finding and matching](#stringprototype-finding-and-matching)'
  id: totrans-27
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: '[22.8.4 `String.prototype.*`: 查找和匹配](#stringprototype-finding-and-matching)'
- en: '[22.8.5 `String.prototype.*`: extracting](#stringprototype-extracting)'
  id: totrans-28
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: '[22.8.5 `String.prototype.*`: 提取](#stringprototype-extracting)'
- en: '[22.8.6 `String.prototype.*`: combining](#stringprototype-combining)'
  id: totrans-29
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: '[22.8.6 `String.prototype.*`: 组合](#stringprototype-combining)'
- en: '[22.8.7 `String.prototype.*`: transforming](#stringprototype-transforming)'
  id: totrans-30
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: '[22.8.7 `String.prototype.*`: 转换](#stringprototype-transforming)'
- en: '[22.8.8 Sources of this quick reference](#sources-of-this-quick-reference)'
  id: totrans-31
  prefs:
  - PREF_IND
  - PREF_OL
  type: TYPE_NORMAL
  zh: '[22.8.8 本快速参考的来源](#sources-of-this-quick-reference)'
- en: '[22.1 Cheat sheet: strings](#cheat-sheet-strings)'
  id: totrans-32
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '[22.1 速查表：字符串](#cheat-sheet-strings)'
- en: Strings are primitive values in JavaScript and immutable. That is, string-related
    operations always produce new strings and never change existing strings.
  id: totrans-33
  prefs: []
  type: TYPE_NORMAL
  zh: 在 JavaScript 中，字符串是原始值且不可变。也就是说，与字符串相关的操作总是产生新的字符串，而不会更改现有的字符串。
- en: '[22.1.1 Working with strings](#working-with-strings)'
  id: totrans-34
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '[22.1.1 处理字符串](#working-with-strings)'
- en: 'Literals for strings:'
  id: totrans-35
  prefs: []
  type: TYPE_NORMAL
  zh: 字符串字面量：
- en: '[PRE0]'
  id: totrans-36
  prefs: []
  type: TYPE_PRE
  zh: '[PRE0]'
- en: 'Backslashes are used to:'
  id: totrans-37
  prefs: []
  type: TYPE_NORMAL
  zh: 反斜杠用于：
- en: Escape literal delimiters (first 2 lines of previous example)
  id: totrans-38
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 转义字面量分隔符（前两个示例的示例的第一行和第二行）
- en: 'Represent special characters:'
  id: totrans-39
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 表示特殊字符：
- en: '`\\` represents a backslash'
  id: totrans-40
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`\\` 表示反斜杠'
- en: '`\n` represents a newline'
  id: totrans-41
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`\n` 表示换行符'
- en: '`\r` represents a carriage return'
  id: totrans-42
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`\r` 表示回车符'
- en: '`\t` represents a tab'
  id: totrans-43
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`\t` 表示制表符'
- en: 'Inside a `String.raw` tagged template (line A), backslashes are treated as
    normal characters:'
  id: totrans-44
  prefs: []
  type: TYPE_NORMAL
  zh: 在 `String.raw` 标签模板（行 A）内部，反斜杠被视为普通字符：
- en: '[PRE1]'
  id: totrans-45
  prefs: []
  type: TYPE_PRE
  zh: '[PRE1]'
- en: 'Convertings values to strings:'
  id: totrans-46
  prefs: []
  type: TYPE_NORMAL
  zh: 将值转换为字符串：
- en: '[PRE2]'
  id: totrans-47
  prefs: []
  type: TYPE_PRE
  zh: '[PRE2]'
- en: Copying parts of a string
  id: totrans-48
  prefs: []
  type: TYPE_NORMAL
  zh: 复制字符串的一部分
- en: '[PRE3]'
  id: totrans-49
  prefs: []
  type: TYPE_PRE
  zh: '[PRE3]'
- en: 'Concatenating strings:'
  id: totrans-50
  prefs: []
  type: TYPE_NORMAL
  zh: 字符串连接：
- en: '[PRE4]'
  id: totrans-51
  prefs: []
  type: TYPE_PRE
  zh: '[PRE4]'
- en: '[22.1.2 JavaScript characters vs. code points vs. grapheme clusters](#javascript-characters-vs-code-points-vs-grapheme-clusters)'
  id: totrans-52
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '[22.1.2 JavaScript 字符与码点与图形簇](#javascript-characters-vs-code-points-vs-grapheme-clusters)'
- en: '**Code points** are 21-bit Unicode characters.'
  id: totrans-53
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**码点**是 21 位 Unicode 字符。'
- en: '**JavaScript characters** are 16-bit UTF-16 code units. To encode a code point,
    we need one to two code units. Most code points fit into one code unit.'
  id: totrans-54
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**JavaScript 字符**是 16 位 UTF-16 码单元。为了编码一个码点，我们需要一个到两个码单元。大多数码点适合在一个码单元中。'
- en: '**Grapheme clusters** are *user-perceived characters* and represent written
    symbols. Most grapheme clusters are only one code point long, but they can also
    be longer – e.g., some emojis.'
  id: totrans-55
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**图形簇**是*用户感知字符*，代表书写符号。大多数图形簇只有一个码点长，但它们也可以更长——例如，一些表情符号。'
- en: 'Example – a grapheme cluster that consists of multiple code points:'
  id: totrans-56
  prefs: []
  type: TYPE_NORMAL
  zh: 示例——由多个码点组成的图形簇：
- en: '[PRE5]'
  id: totrans-57
  prefs: []
  type: TYPE_PRE
  zh: '[PRE5]'
- en: 'For more information on how to handle text, see [“Atoms of text: code points,
    JavaScript characters, grapheme clusters” (§22.7)](#atoms-of-text).'
  id: totrans-58
  prefs: []
  type: TYPE_NORMAL
  zh: 更多关于如何处理文本的信息，请参阅[“文本原子：码点、JavaScript 字符、图形簇”（§22.7）](#atoms-of-text)。
- en: '[22.1.3 String methods](#string-methods)'
  id: totrans-59
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '[22.1.3 字符串方法](#string-methods)'
- en: This subsection gives a brief overview of the string API. There is [a more comprehensive
    quick reference](#quickref-string) at the end of this chapter.
  id: totrans-60
  prefs: []
  type: TYPE_NORMAL
  zh: 本小节简要概述了字符串 API。本章末尾有一个更全面的快速参考[快速参考](#quickref-string)。
- en: 'Finding substrings:'
  id: totrans-61
  prefs: []
  type: TYPE_NORMAL
  zh: 查找子字符串：
- en: '[PRE6]'
  id: totrans-62
  prefs: []
  type: TYPE_PRE
  zh: '[PRE6]'
- en: 'Splitting and joining:'
  id: totrans-63
  prefs: []
  type: TYPE_NORMAL
  zh: 分割和连接：
- en: '[PRE7]'
  id: totrans-64
  prefs: []
  type: TYPE_PRE
  zh: '[PRE7]'
- en: 'Padding and trimming:'
  id: totrans-65
  prefs: []
  type: TYPE_NORMAL
  zh: 填充和修剪：
- en: '[PRE8]'
  id: totrans-66
  prefs: []
  type: TYPE_PRE
  zh: '[PRE8]'
- en: 'Repeating and changing case:'
  id: totrans-67
  prefs: []
  type: TYPE_NORMAL
  zh: 重复和更改大小写：
- en: '[PRE9]'
  id: totrans-68
  prefs: []
  type: TYPE_PRE
  zh: '[PRE9]'
- en: '[22.2 Plain string literals](#plain-string-literals)'
  id: totrans-69
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '[22.2 平凡字符串字面量](#plain-string-literals)'
- en: 'Plain string literals are delimited by either single quotes or double quotes:'
  id: totrans-70
  prefs: []
  type: TYPE_NORMAL
  zh: 平凡字符串字面量由单引号或双引号分隔：
- en: '[PRE10]'
  id: totrans-71
  prefs: []
  type: TYPE_PRE
  zh: '[PRE10]'
- en: Single quotes are used more often because it makes it easier to mention HTML,
    where double quotes are preferred.
  id: totrans-72
  prefs: []
  type: TYPE_NORMAL
  zh: 单引号使用得更频繁，因为它使得提及 HTML 更容易，在 HTML 中双引号是首选的。
- en: '[The next chapter](ch_template-literals.html#ch_template-literals) covers *template
    literals*, which give us:'
  id: totrans-73
  prefs: []
  type: TYPE_NORMAL
  zh: '[下一章](ch_template-literals.html#ch_template-literals)介绍了*模板字面量*，它给我们：'
- en: String interpolation
  id: totrans-74
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 字符串插值
- en: Multiple lines
  id: totrans-75
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 多行
- en: Raw string literals (backslash has no special meaning)
  id: totrans-76
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 原始字符串字面量（反斜杠没有特殊含义）
- en: '[22.2.1 Escaping](#escaping)'
  id: totrans-77
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '[22.2.1 转义](#escaping)'
- en: 'The backslash lets us create special characters:'
  id: totrans-78
  prefs: []
  type: TYPE_NORMAL
  zh: 反斜杠允许我们创建特殊字符：
- en: 'Unix line break: `''\n''`'
  id: totrans-79
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Unix 行结束符：`'\n'`
- en: 'Windows line break: `''\r\n''`'
  id: totrans-80
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Windows 行结束符：`'\r\n'`
- en: 'Tab: `''\t''`'
  id: totrans-81
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 制表符：`'\t'`
- en: 'Backslash: `''\\''`'
  id: totrans-82
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 反斜杠：`'\\'`
- en: 'The backslash also lets us use the delimiter of a string literal inside that
    literal:'
  id: totrans-83
  prefs: []
  type: TYPE_NORMAL
  zh: 反斜杠还允许我们在字符串字面量内部使用该字面量的分隔符：
- en: '[PRE11]'
  id: totrans-84
  prefs: []
  type: TYPE_PRE
  zh: '[PRE11]'
- en: '[22.3 Accessing JavaScript characters](#accessing-javascript-characters)'
  id: totrans-85
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '[22.3 访问 JavaScript 字符](#accessing-javascript-characters)'
- en: JavaScript has no extra data type for characters – characters are always represented
    as strings.
  id: totrans-86
  prefs: []
  type: TYPE_NORMAL
  zh: JavaScript 没有额外的字符数据类型——字符始终以字符串的形式表示。
- en: '[PRE12]'
  id: totrans-87
  prefs: []
  type: TYPE_PRE
  zh: '[PRE12]'
- en: 'The characters we see on screen are called *grapheme clusters*. Most of them
    are represented by single JavaScript characters. However, there are also grapheme
    clusters (especially emojis) that are represented by multiple JavaScript characters:'
  id: totrans-88
  prefs: []
  type: TYPE_NORMAL
  zh: 我们在屏幕上看到的字符被称为*图形簇*。其中大多数由单个 JavaScript 字符表示。然而，也有一些图形簇（特别是表情符号）由多个 JavaScript
    字符表示：
- en: '[PRE13]'
  id: totrans-89
  prefs: []
  type: TYPE_PRE
  zh: '[PRE13]'
- en: 'How that works is explained in [“Atoms of text: code points, JavaScript characters,
    grapheme clusters” (§22.7)](#atoms-of-text).'
  id: totrans-90
  prefs: []
  type: TYPE_NORMAL
  zh: 这是如何工作的解释见[“文本原子：码点、JavaScript 字符、图形簇”（§22.7）](#atoms-of-text)。
- en: '[22.4 String concatenation](#string-concatenation)'
  id: totrans-91
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '[22.4 字符串连接](#string-concatenation)'
- en: '[22.4.1 String concatenation via `+`](#string-concatenation-via-plus)'
  id: totrans-92
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '[22.4.1 通过 `+` 进行字符串连接](#string-concatenation-via-plus)'
- en: 'If at least one operand is a string, the plus operator (`+`) converts any non-strings
    to strings and concatenates the result:'
  id: totrans-93
  prefs: []
  type: TYPE_NORMAL
  zh: 如果至少有一个操作数是字符串，则加号运算符（`+`）将任何非字符串转换为字符串并将结果连接起来：
- en: '[PRE14]'
  id: totrans-94
  prefs: []
  type: TYPE_PRE
  zh: '[PRE14]'
- en: 'The assignment operator `+=` is useful if we want to assemble a string, piece
    by piece:'
  id: totrans-95
  prefs: []
  type: TYPE_NORMAL
  zh: 赋值运算符 `+=` 如果我们想逐步组装一个字符串，那么它很有用：
- en: '[PRE15]'
  id: totrans-96
  prefs: []
  type: TYPE_PRE
  zh: '[PRE15]'
- en: '![Icon “details”](../Images/38ba63de820aae6f94a019538ae0f222.png) **Concatenating
    via `+` is efficient**'
  id: totrans-97
  prefs: []
  type: TYPE_NORMAL
  zh: '![Icon “details”](../Images/38ba63de820aae6f94a019538ae0f222.png) **通过 `+`
    连接是高效的**'
- en: Using `+` to assemble strings is quite efficient because most JavaScript engines
    internally optimize it.
  id: totrans-98
  prefs: []
  type: TYPE_NORMAL
  zh: 使用 `+` 组装字符串相当高效，因为大多数 JavaScript 引擎都会对其进行内部优化。
- en: '![Icon “exercise”](../Images/4fc2ec98bb44cc1f4de7c6a46d9dd043.png) **Exercise:
    Concatenating strings**'
  id: totrans-99
  prefs: []
  type: TYPE_NORMAL
  zh: '![Icon “exercise”](../Images/4fc2ec98bb44cc1f4de7c6a46d9dd043.png) **练习：字符串连接**'
- en: '`exercises/strings/concat_string_array_test.mjs`'
  id: totrans-100
  prefs: []
  type: TYPE_NORMAL
  zh: '`exercises/strings/concat_string_array_test.mjs`'
- en: '[22.4.2 Concatenating via Arrays (`.push()` and `.join()`)](#string-concatenation-via-arrays)'
  id: totrans-101
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '[22.4.2 通过数组进行连接（`.push()` 和 `.join()`）](#string-concatenation-via-arrays)'
- en: 'Occasionally, taking a detour via an Array can be useful for concatenating
    strings – especially if there is to be a separator between them (such as `'',
    ''` in line A):'
  id: totrans-102
  prefs: []
  type: TYPE_NORMAL
  zh: 有时，通过数组绕道进行字符串连接可能会有用，特别是如果它们之间需要分隔符（例如行A中的 `', '`）：
- en: '[PRE16]'
  id: totrans-103
  prefs: []
  type: TYPE_PRE
  zh: '[PRE16]'
- en: '[22.5 Converting values to strings in JavaScript has pitfalls](#converting-values-to-strings)'
  id: totrans-104
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '[22.5 JavaScript中转换值到字符串的陷阱](#converting-values-to-strings)'
- en: 'Converting values to strings in JavaScript is more complicated than it might
    seem:'
  id: totrans-105
  prefs: []
  type: TYPE_NORMAL
  zh: JavaScript中将值转换为字符串比看起来要复杂：
- en: Most approaches have values they can’t handle.
  id: totrans-106
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 大多数方法都有它们无法处理的值。
- en: We don’t always see all of the data.
  id: totrans-107
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 我们并不总是看到所有的数据。
- en: '[22.5.1 Example: code that is problematic](#example-code-that-is-problematic)'
  id: totrans-108
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '[22.5.1 示例：有问题的代码](#example-code-that-is-problematic)'
- en: Can you spot the problem in the following code?
  id: totrans-109
  prefs: []
  type: TYPE_NORMAL
  zh: 你能否在以下代码中找到问题？
- en: '[PRE17]'
  id: totrans-110
  prefs: []
  type: TYPE_PRE
  zh: '[PRE17]'
- en: 'For some values, this code throws an exception in line A:'
  id: totrans-111
  prefs: []
  type: TYPE_NORMAL
  zh: 对于某些值，这段代码在行A抛出异常：
- en: '[PRE18]'
  id: totrans-112
  prefs: []
  type: TYPE_PRE
  zh: '[PRE18]'
- en: Read on for more information.
  id: totrans-113
  prefs: []
  type: TYPE_NORMAL
  zh: 继续阅读以获取更多信息。
- en: '[22.5.2 Four common ways of converting values to strings](#four-common-ways-of-converting-values-to-strings)'
  id: totrans-114
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '[22.5.2 四种常见的将值转换为字符串的方法](#four-common-ways-of-converting-values-to-strings)'
- en: '`String(v)`'
  id: totrans-115
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`String(v)`'
- en: '`v.toString()`'
  id: totrans-116
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`v.toString()`'
- en: '`'''' + v`'
  id: totrans-117
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`'''' + v`'
- en: '`` `${v}` ``'
  id: totrans-118
  prefs:
  - PREF_OL
  type: TYPE_NORMAL
  zh: '`` `${v}` ``'
- en: 'The following table shows how these operations fare with various values (#4
    produces the same results as #3).'
  id: totrans-119
  prefs: []
  type: TYPE_NORMAL
  zh: 以下表格显示了这些操作与各种值的表现情况（#4产生的结果与#3相同）。
- en: '|  | `String(v)` | `'''' + v` | `v.toString()` |'
  id: totrans-120
  prefs: []
  type: TYPE_TB
  zh: '|  | `String(v)` | `'''' + v` | `v.toString()` |'
- en: '| --- | --- | --- | --- |'
  id: totrans-121
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- | --- |'
- en: '| `undefined` | `''undefined''` | `''undefined''` | **TypeError** |'
  id: totrans-122
  prefs: []
  type: TYPE_TB
  zh: '| `undefined` | `''undefined''` | `''undefined''` | **TypeError** |'
- en: '| `null` | `''null''` | `''null''` | **TypeError** |'
  id: totrans-123
  prefs: []
  type: TYPE_TB
  zh: '| `null` | `''null''` | `''null''` | **TypeError** |'
- en: '| `true` | `''true''` | `''true''` | `''true''` |'
  id: totrans-124
  prefs: []
  type: TYPE_TB
  zh: '| `true` | `''true''` | `''true''` | `''true''` |'
- en: '| `123` | `''123''` | `''123''` | `''123''` |'
  id: totrans-125
  prefs: []
  type: TYPE_TB
  zh: '| `123` | `''123''` | `''123''` | `''123''` |'
- en: '| `123n` | `''123''` | `''123''` | `''123''` |'
  id: totrans-126
  prefs: []
  type: TYPE_TB
  zh: '| `123n` | `''123''` | `''123''` | `''123''` |'
- en: '| `"abc"` | `''abc''` | `''abc''` | `''abc''` |'
  id: totrans-127
  prefs: []
  type: TYPE_TB
  zh: '| `"abc"` | `''abc''` | `''abc''` | `''abc''` |'
- en: '| `Symbol()` | `''Symbol()''` | **TypeError** | `''Symbol()''` |'
  id: totrans-128
  prefs: []
  type: TYPE_TB
  zh: '| `Symbol()` | `''Symbol()''` | **TypeError** | `''Symbol()''` |'
- en: '| `{a:1}` | `''[object Object]''` | `''[object Object]''` | `''[object Object]''`
    |'
  id: totrans-129
  prefs: []
  type: TYPE_TB
  zh: '| `{a:1}` | `''[object Object]''` | `''[object Object]''` | `''[object Object]''`
    |'
- en: '| `[''a'']` | `''a''` | `''a''` | `''a''` |'
  id: totrans-130
  prefs: []
  type: TYPE_TB
  zh: '| `[''a'']` | `''a''` | `''a''` | `''a''` |'
- en: '| `{__proto__:null}` | **TypeError** | **TypeError** | **TypeError** |'
  id: totrans-131
  prefs: []
  type: TYPE_TB
  zh: '| `{__proto__:null}` | **TypeError** | **TypeError** | **TypeError** |'
- en: '| `Symbol.prototype` | **TypeError** | **TypeError** | **TypeError** |'
  id: totrans-132
  prefs: []
  type: TYPE_TB
  zh: '| `Symbol.prototype` | **TypeError** | **TypeError** | **TypeError** |'
- en: '| `() => {}` | `''() => {}''` | `''() => {}''` | `''() => {}''` |'
  id: totrans-133
  prefs: []
  type: TYPE_TB
  zh: '| `() => {}` | `''() => {}''` | `''() => {}''` | `''() => {}''` |'
- en: Let’s explore why some of these values produce exceptions or results that aren’t
    very useful.
  id: totrans-134
  prefs: []
  type: TYPE_NORMAL
  zh: 让我们探究为什么这些值会产生异常或不是非常有用的结果。
- en: '[22.5.2.1 Tricky values: symbols](#tricky-values-symbols)'
  id: totrans-135
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '[22.5.2.1 棘手值：符号](#tricky-values-symbols)'
- en: 'Symbols must be converted to strings explicitly (via `String()` or `.toString()`).
    Conversion via concatenation throws an exception:'
  id: totrans-136
  prefs: []
  type: TYPE_NORMAL
  zh: 符号必须显式地转换为字符串（通过 `String()` 或 `.toString()`）。通过连接转换会抛出异常：
- en: '[PRE19]'
  id: totrans-137
  prefs: []
  type: TYPE_PRE
  zh: '[PRE19]'
- en: Why is that? The intent is to prevent accidentally converting a symbol property
    key to a string (which is also a valid property key).
  id: totrans-138
  prefs: []
  type: TYPE_NORMAL
  zh: 为什么会这样？目的是为了防止意外地将一个符号属性键转换为字符串（这同样也是一个有效的属性键）。
- en: '[22.5.2.2 Tricky values: objects with `null` prototypes](#tricky-values-objects-with-null-prototypes)'
  id: totrans-139
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '[22.5.2.2 棘手值：具有 `null` 原型的对象](#tricky-values-objects-with-null-prototypes)'
- en: 'It’s obvious why `v.toString()` doesn’t work if there is no method `.toString()`.
    However, the other conversion operations call the following methods in the following
    order and use the first primitive value that is returned (after converting it
    to string):'
  id: totrans-140
  prefs: []
  type: TYPE_NORMAL
  zh: 如果没有 `.toString()` 方法，`v.toString()` 不起作用的原因很明显。然而，其他转换操作会按照以下顺序调用以下方法，并使用返回的第一个原始值（在将其转换为字符串后）：
- en: '`v[Symbol.toPrimitive]()`'
  id: totrans-141
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`v[Symbol.toPrimitive]()`'
- en: '`v.toString()`'
  id: totrans-142
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`v.toString()`'
- en: '`v.valueOf()`'
  id: totrans-143
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`v.valueOf()`'
- en: If none of these methods are present, a `TypeError` is thrown.
  id: totrans-144
  prefs: []
  type: TYPE_NORMAL
  zh: 如果这些方法中没有一个存在，则会抛出 `TypeError`。
- en: '[PRE20]'
  id: totrans-145
  prefs: []
  type: TYPE_PRE
  zh: '[PRE20]'
- en: Where might we encounter objects with `null` prototypes?
  id: totrans-146
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可能在哪些地方遇到具有 `null` 原型的对象？
- en: '[“Objects with `null` prototypes as dictionaries” (§30.9.11.4)](ch_objects.html#dictionary-objects-with-null-prototypes)'
  id: totrans-147
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[“具有 `null` 原型的对象作为字典”（§30.9.11.4）](ch_objects.html#dictionary-objects-with-null-prototypes)'
- en: '[“Objects with `null` prototypes as fixed lookup tables” (§30.9.11.5)](ch_objects.html#lookup-tables-with-null-prototypes)'
  id: totrans-148
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[“具有 `null` 原型的对象作为固定查找表”（§30.9.11.5）](ch_objects.html#lookup-tables-with-null-prototypes)'
- en: '[“`null` prototypes in the standard library” (§30.9.11.6)](ch_objects.html#null-prototypes-in-standard-library)'
  id: totrans-149
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[“标准库中的 `null` 原型”（§30.9.11.6）](ch_objects.html#null-prototypes-in-standard-library)'
- en: '[22.5.2.3 Tricky values: objects in general](#tricky-values-objects-in-general)'
  id: totrans-150
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '[22.5.2.3 诡异的值：一般对象](#tricky-values-objects-in-general)'
- en: 'Plain objects have default string representations that are not very useful:'
  id: totrans-151
  prefs: []
  type: TYPE_NORMAL
  zh: 简单对象默认的字符串表示并不很有用：
- en: '[PRE21]'
  id: totrans-152
  prefs: []
  type: TYPE_PRE
  zh: '[PRE21]'
- en: 'Arrays have better string representations, but they still hide much information:'
  id: totrans-153
  prefs: []
  type: TYPE_NORMAL
  zh: 数组有更好的字符串表示，但它们仍然隐藏了很多信息：
- en: '[PRE22]'
  id: totrans-154
  prefs: []
  type: TYPE_PRE
  zh: '[PRE22]'
- en: '[22.5.2.4 Tricky value: `Symbol.prototype`](#tricky-value-symbolprototype)'
  id: totrans-155
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '[22.5.2.4 诡异的值：`Symbol.prototype`](#tricky-value-symbolprototype)'
- en: 'You’ll probably never encounter the value `Symbol.prototype` (the object that
    provides symbols with methods) in the wild but it’s an interesting edge case:
    `Symbol.prototype[Symbol.toPrimitive]()` throws an exception if `this` isn’t a
    symbol. That explains why converting `Symbol.prototype` to a string doesn’t work:'
  id: totrans-156
  prefs: []
  type: TYPE_NORMAL
  zh: 你可能永远不会在野外遇到 `Symbol.prototype`（提供符号方法的对象）这个值，但它是一个有趣的边缘情况：如果 `this` 不是一个符号，`Symbol.prototype[Symbol.toPrimitive]()`
    会抛出异常。这解释了为什么将 `Symbol.prototype` 转换为字符串不起作用：
- en: '[PRE23]'
  id: totrans-157
  prefs: []
  type: TYPE_PRE
  zh: '[PRE23]'
- en: '[22.5.3 Using `JSON.stringify()` to convert values to strings](#using-jsonstringify-to-convert-values-to-strings)'
  id: totrans-158
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '[22.5.3 使用 `JSON.stringify()` 将值转换为字符串](#using-jsonstringify-to-convert-values-to-strings)'
- en: 'The JSON data format is a text representation of JavaScript values. Therefore,
    [`JSON.stringify()`](ch_json.html#JSON.stringify) can also be used to convert
    values to strings. It works especially well for objects and Arrays where the normal
    conversion to string has significant deficiencies:'
  id: totrans-159
  prefs: []
  type: TYPE_NORMAL
  zh: JSON 数据格式是 JavaScript 值的文本表示。因此，[`JSON.stringify()`](ch_json.html#JSON.stringify)
    也可以用来将值转换为字符串。它在对象和数组中特别有效，因为正常的字符串转换有显著的不足：
- en: '[PRE24]'
  id: totrans-160
  prefs: []
  type: TYPE_PRE
  zh: '[PRE24]'
- en: '`JSON.stringify()` is OK with objects whose prototypes are `null`:'
  id: totrans-161
  prefs: []
  type: TYPE_NORMAL
  zh: '`JSON.stringify()` 对原型为 `null` 的对象没有问题：'
- en: '[PRE25]'
  id: totrans-162
  prefs: []
  type: TYPE_PRE
  zh: '[PRE25]'
- en: 'On major downside is that `JSON.stringify()` only supports the following values:'
  id: totrans-163
  prefs: []
  type: TYPE_NORMAL
  zh: 主要缺点是 `JSON.stringify()` 只支持以下值：
- en: 'Primitive values:'
  id: totrans-164
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 原始值：
- en: '`null`'
  id: totrans-165
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`null`'
- en: Booleans
  id: totrans-166
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 布尔值
- en: Numbers (except for `NaN` and `Infinity`)
  id: totrans-167
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 数字（除了 `NaN` 和 `Infinity`）
- en: Strings
  id: totrans-168
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 字符串
- en: 'Non-primitive values:'
  id: totrans-169
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 非原始值：
- en: Arrays
  id: totrans-170
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 数组
- en: Objects (except for functions)
  id: totrans-171
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 对象（除了函数）
- en: 'For most other values, we get `undefined` as a result (and not a string):'
  id: totrans-172
  prefs: []
  type: TYPE_NORMAL
  zh: 对于大多数其他值，我们得到的结果是 `undefined`（而不是字符串）：
- en: '[PRE26]'
  id: totrans-173
  prefs: []
  type: TYPE_PRE
  zh: '[PRE26]'
- en: 'Bigints cause exceptions:'
  id: totrans-174
  prefs: []
  type: TYPE_NORMAL
  zh: 大整数会导致异常：
- en: '[PRE27]'
  id: totrans-175
  prefs: []
  type: TYPE_PRE
  zh: '[PRE27]'
- en: 'Properties with `undefined`-producing values are omitted:'
  id: totrans-176
  prefs: []
  type: TYPE_NORMAL
  zh: 产生 `undefined` 值的属性被省略：
- en: '[PRE28]'
  id: totrans-177
  prefs: []
  type: TYPE_PRE
  zh: '[PRE28]'
- en: 'Array elements whose values produce `undefined`, are stringified as `null`:'
  id: totrans-178
  prefs: []
  type: TYPE_NORMAL
  zh: 数组元素中的值产生 `undefined` 时，会被转换为 `null`：
- en: '[PRE29]'
  id: totrans-179
  prefs: []
  type: TYPE_PRE
  zh: '[PRE29]'
- en: 'The following table summarizes the results of `JSON.stringify(v)`:'
  id: totrans-180
  prefs: []
  type: TYPE_NORMAL
  zh: 下表总结了 `JSON.stringify(v)` 的结果：
- en: '|  | `JSON.stringify(v)` |'
  id: totrans-181
  prefs: []
  type: TYPE_TB
  zh: '|  | `JSON.stringify(v)` |'
- en: '| --- | --- |'
  id: totrans-182
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| `undefined` | `undefined` |'
  id: totrans-183
  prefs: []
  type: TYPE_TB
  zh: '| `undefined` | `undefined` |'
- en: '| `null` | `''null''` |'
  id: totrans-184
  prefs: []
  type: TYPE_TB
  zh: '| `null` | `''null''` |'
- en: '| `true` | `''true''` |'
  id: totrans-185
  prefs: []
  type: TYPE_TB
  zh: '| `true` | `''true''` |'
- en: '| `123` | `''123''` |'
  id: totrans-186
  prefs: []
  type: TYPE_TB
  zh: '| `123` | `''123''` |'
- en: '| `123n` | **TypeError** |'
  id: totrans-187
  prefs: []
  type: TYPE_TB
  zh: '| `123n` | **TypeError** |'
- en: '| `''abc''` | `''"abc"''` |'
  id: totrans-188
  prefs: []
  type: TYPE_TB
  zh: '| `''abc''` | `''"abc"''` |'
- en: '| `Symbol()` | `undefined` |'
  id: totrans-189
  prefs: []
  type: TYPE_TB
  zh: '| `Symbol()` | `undefined` |'
- en: '| `{a:1}` | `''{"a":1}''` |'
  id: totrans-190
  prefs: []
  type: TYPE_TB
  zh: '| `{a:1}` | `''{"a":1}''` |'
- en: '| `[''a'']` | `''["a"]''` |'
  id: totrans-191
  prefs: []
  type: TYPE_TB
  zh: '| `[''a'']` | `''["a"]''` |'
- en: '| `() => {}` | `undefined` |'
  id: totrans-192
  prefs: []
  type: TYPE_TB
  zh: '| `() => {}` | `undefined` |'
- en: '| `{__proto__:null}` | `''{}''` |'
  id: totrans-193
  prefs: []
  type: TYPE_TB
  zh: '| `{__proto__:null}` | `''{}''` |'
- en: '| `Symbol.prototype` | `''{}''` |'
  id: totrans-194
  prefs: []
  type: TYPE_TB
  zh: '| `Symbol.prototype` | `''{}''` |'
- en: For more information, see [“Details on how data is converted to JSON” (§48.3.1.3)](ch_json.html#json-stringify-details).
  id: totrans-195
  prefs: []
  type: TYPE_NORMAL
  zh: 更多信息，请参阅[“数据转换为 JSON 的详细信息”（§48.3.1.3）](ch_json.html#json-stringify-details)。
- en: '[22.5.3.1 Multiline output](#multiline-output)'
  id: totrans-196
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '[22.5.3.1 多行输出](#multiline-output)'
- en: 'By default, `JSON.stringify()` returns a single line of text. However the optional
    third parameter enables multiline output and lets us specify how much to indent
    – for example:'
  id: totrans-197
  prefs: []
  type: TYPE_NORMAL
  zh: 默认情况下，`JSON.stringify()` 返回单行文本。但是，可选的第三个参数可以启用多行输出，并允许我们指定缩进量 - 例如：
- en: '[PRE30]'
  id: totrans-198
  prefs: []
  type: TYPE_PRE
  zh: '[PRE30]'
- en: '[22.5.3.2 Displaying strings via `JSON.stringify()`](#displaying-strings-via-jsonstringify)'
  id: totrans-199
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '[22.5.3.2 通过 `JSON.stringify()` 显示字符串](#displaying-strings-via-jsonstringify)'
- en: '`JSON.stringify()` is useful for displaying arbitrary strings:'
  id: totrans-200
  prefs: []
  type: TYPE_NORMAL
  zh: '`JSON.stringify()` 对于显示任意字符串很有用：'
- en: The result always fits into a single line.
  id: totrans-201
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 结果总是适合单行。
- en: Invisible characters such as newlines and tabs become visible.
  id: totrans-202
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 不可见字符，如换行符和制表符，变得可见。
- en: 'Example:'
  id: totrans-203
  prefs: []
  type: TYPE_NORMAL
  zh: 示例：
- en: '[PRE31]'
  id: totrans-204
  prefs: []
  type: TYPE_PRE
  zh: '[PRE31]'
- en: 'Output:'
  id: totrans-205
  prefs: []
  type: TYPE_NORMAL
  zh: 输出：
- en: '[PRE32]'
  id: totrans-206
  prefs: []
  type: TYPE_PRE
  zh: '[PRE32]'
- en: '[22.5.4 Solutions](#solutions)'
  id: totrans-207
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '[22.5.4 解决方案](#solutions)'
- en: Alas, there are no good built-in solutions for stringification that work all
    the time. In this section, we’ll explore a short function that works for all simple
    use cases, along with solutions for more sophisticated use cases.
  id: totrans-208
  prefs: []
  type: TYPE_NORMAL
  zh: 遗憾的是，没有好的内置字符串化解决方案始终有效。在本节中，我们将探讨一个适用于所有简单用例的短函数，以及更复杂用例的解决方案。
- en: '[22.5.4.1 Short solution: a custom `toString()` function](#short-solution-a-custom-tostring-function)'
  id: totrans-209
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '[22.5.4.1 简单解决方案：自定义 `toString()` 函数](#short-solution-a-custom-tostring-function)'
- en: What would a simple solution for stringification look like?
  id: totrans-210
  prefs: []
  type: TYPE_NORMAL
  zh: 字符串化的简单解决方案会是什么样子？
- en: '`JSON.stringify()` works well for a lot of data, especially plain objects and
    Arrays. If it can’t stringify a given value, it returns `undefined` instead of
    a string – unless the value is a bigint. Then it throws an exception.'
  id: totrans-211
  prefs: []
  type: TYPE_NORMAL
  zh: '`JSON.stringify()` 对于许多数据都工作得很好，特别是普通对象和数组。如果它无法将给定的值字符串化，则返回 `undefined` 而不是字符串——除非该值是
    `bigint`。然后它抛出异常。'
- en: 'Therefore, we can use the following function for stringification:'
  id: totrans-212
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，我们可以使用以下函数进行字符串化：
- en: '[PRE33]'
  id: totrans-213
  prefs: []
  type: TYPE_PRE
  zh: '[PRE33]'
- en: 'For values that are not supported by `JSON.stringify()`, we use `String()`
    as a fallback (line A). That function only throws for the following two values
    – which are both handled well by `JSON.stringify()`:'
  id: totrans-214
  prefs: []
  type: TYPE_NORMAL
  zh: 对于不支持 `JSON.stringify()` 的值，我们使用 `String()` 作为后备（行 A）。该函数只对以下两个值抛出异常——这两个值都由
    `JSON.stringify()` 良好处理：
- en: '`{__proto__:null}`'
  id: totrans-215
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`{__proto__:null}`'
- en: '`Symbol.prototype`'
  id: totrans-216
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`Symbol.prototype`'
- en: 'The following table summarizes the results of `toString()`:'
  id: totrans-217
  prefs: []
  type: TYPE_NORMAL
  zh: 下表总结了 `toString()` 的结果：
- en: '|  | `toString()` |'
  id: totrans-218
  prefs: []
  type: TYPE_TB
  zh: '|  | `toString()` |'
- en: '| --- | --- |'
  id: totrans-219
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| `undefined` | `''undefined''` |'
  id: totrans-220
  prefs: []
  type: TYPE_TB
  zh: '| `undefined` | `''undefined''` |'
- en: '| `null` | `''null''` |'
  id: totrans-221
  prefs: []
  type: TYPE_TB
  zh: '| `null` | `''null''` |'
- en: '| `true` | `''true''` |'
  id: totrans-222
  prefs: []
  type: TYPE_TB
  zh: '| `true` | `''true''` |'
- en: '| `123` | `''123''` |'
  id: totrans-223
  prefs: []
  type: TYPE_TB
  zh: '| `123` | `''123''` |'
- en: '| `123n` | `''123n''` |'
  id: totrans-224
  prefs: []
  type: TYPE_TB
  zh: '| `123n` | `''123n''` |'
- en: '| `''abc''` | `''"abc"''` |'
  id: totrans-225
  prefs: []
  type: TYPE_TB
  zh: '| `''abc''` | `''"abc"''` |'
- en: '| `Symbol()` | `''Symbol()''` |'
  id: totrans-226
  prefs: []
  type: TYPE_TB
  zh: '| `Symbol()` | `''Symbol()''` |'
- en: '| `{a:1}` | `''{"a":1}''` |'
  id: totrans-227
  prefs: []
  type: TYPE_TB
  zh: '| `{a:1}` | `''{"a":1}''` |'
- en: '| `[''a'']` | `''["a"]''` |'
  id: totrans-228
  prefs: []
  type: TYPE_TB
  zh: '| `[''a'']` | `''["a"]''` |'
- en: '| `() => {}` | `''() => {}''` |'
  id: totrans-229
  prefs: []
  type: TYPE_TB
  zh: '| `() => {}` | `''() => {}''` |'
- en: '| `{__proto__:null}` | `''{}''` |'
  id: totrans-230
  prefs: []
  type: TYPE_TB
  zh: '| `{__proto__:null}` | `''{}''` |'
- en: '| `Symbol.prototype` | `''{}''` |'
  id: totrans-231
  prefs: []
  type: TYPE_TB
  zh: '| `Symbol.prototype` | `''{}''` |'
- en: '[22.5.4.2 Library for stringifying values](#library-for-stringifying-values)'
  id: totrans-232
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '[22.5.4.2 用于字符串化的库](#library-for-stringifying-values)'
- en: 'The library [stringify-object](https://github.com/sindresorhus/stringify-object)
    by Sindre Sorhus: “Stringify an object/array like `JSON.stringify` just without
    all the double-quotes”'
  id: totrans-233
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: Sindre Sorhus 的库 [stringify-object](https://github.com/sindresorhus/stringify-object)：“像
    `JSON.stringify` 一样字符串化对象/数组，只是没有所有的双引号”
- en: '[22.5.4.3 Node.js functions for stringifying values](#nodejs-functions-for-stringifying-values)'
  id: totrans-234
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '[22.5.4.3 Node.js 的字符串化值函数](#nodejs-functions-for-stringifying-values)'
- en: 'Node.js has several built-in functions that provide sophisticated support for
    converting JavaScript values to strings – e.g.:'
  id: totrans-235
  prefs: []
  type: TYPE_NORMAL
  zh: Node.js 有几个内置函数，提供了将 JavaScript 值转换为字符串的复杂支持——例如：
- en: '[`util.inspect(obj)`](https://nodejs.org/api/util.html#utilinspectobject-options)
    “returns a string representation of `obj` that is intended for debugging”.'
  id: totrans-236
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[`util.inspect(obj)`](https://nodejs.org/api/util.html#utilinspectobject-options)
    “返回 `obj` 的字符串表示形式，该表示形式旨在用于调试”。'
- en: '[`util.format(format, ...args)`](https://nodejs.org/api/util.html#utilformatformat-args)
    “returns a formatted string using the first argument as a printf-like format string
    which can contain zero or more format specifiers”.'
  id: totrans-237
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[`util.format(format, ...args)`](https://nodejs.org/api/util.html#utilformatformat-args)
    “使用第一个参数作为类似于 printf 的格式字符串返回格式化的字符串，该字符串可以包含零个或多个格式说明符”。'
- en: 'These functions can even handle circular data:'
  id: totrans-238
  prefs: []
  type: TYPE_NORMAL
  zh: 这些函数甚至可以处理循环数据：
- en: '[PRE34]'
  id: totrans-239
  prefs: []
  type: TYPE_PRE
  zh: '[PRE34]'
- en: '[22.5.4.4 Alternative to stringification: logging data to the console](#alternative-to-stringification-logging-data-to-the-console)'
  id: totrans-240
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '[22.5.4.4 字符串化的替代方案：将数据记录到控制台](#alternative-to-stringification-logging-data-to-the-console)'
- en: 'Console methods such as `console.log()` tend to produce good output and have
    few limitations:'
  id: totrans-241
  prefs: []
  type: TYPE_NORMAL
  zh: 控制台方法，如 `console.log()`，通常会产生良好的输出，并且限制很少：
- en: '[PRE35]'
  id: totrans-242
  prefs: []
  type: TYPE_PRE
  zh: '[PRE35]'
- en: 'Output:'
  id: totrans-243
  prefs: []
  type: TYPE_NORMAL
  zh: 输出：
- en: '[PRE36]'
  id: totrans-244
  prefs: []
  type: TYPE_PRE
  zh: '[PRE36]'
- en: 'However, by default, they only display objects up to a certain depth:'
  id: totrans-245
  prefs: []
  type: TYPE_NORMAL
  zh: 然而，默认情况下，它们只显示到一定深度的对象：
- en: '[PRE37]'
  id: totrans-246
  prefs: []
  type: TYPE_PRE
  zh: '[PRE37]'
- en: 'Output:'
  id: totrans-247
  prefs: []
  type: TYPE_NORMAL
  zh: 输出：
- en: '[PRE38]'
  id: totrans-248
  prefs: []
  type: TYPE_PRE
  zh: '[PRE38]'
- en: 'Node.js lets us specify the depth for `console.dir()` – with `null` meaning
    infinite:'
  id: totrans-249
  prefs: []
  type: TYPE_NORMAL
  zh: Node.js 允许我们为 `console.dir()` 指定深度——`null` 表示无限：
- en: '[PRE39]'
  id: totrans-250
  prefs: []
  type: TYPE_PRE
  zh: '[PRE39]'
- en: 'Output:'
  id: totrans-251
  prefs: []
  type: TYPE_NORMAL
  zh: 输出：
- en: '[PRE40]'
  id: totrans-252
  prefs: []
  type: TYPE_PRE
  zh: '[PRE40]'
- en: In browsers, `console.dir()` does not have an options object but lets us interactively
    and incrementally descend into objects.
  id: totrans-253
  prefs: []
  type: TYPE_NORMAL
  zh: 在浏览器中，`console.dir()` 没有选项对象，但允许我们交互式地逐步深入到对象中。
- en: '[22.5.5 Customizing how objects are converted to strings](#customizing-how-objects-are-converted-to-strings)'
  id: totrans-254
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '[22.5.5 自定义对象转换为字符串的方式](#customizing-how-objects-are-converted-to-strings)'
- en: '[22.5.5.1 Customizing the string conversion of objects](#customizing-the-string-conversion-of-objects)'
  id: totrans-255
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '[22.5.5.1 自定义对象的字符串转换](#customizing-the-string-conversion-of-objects)'
- en: 'We can customize the built-in way of stringifying objects by implementing the
    method `.toString()`:'
  id: totrans-256
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以通过实现方法 `.toString()` 来自定义对象字符串化的内置方式：
- en: '[PRE41]'
  id: totrans-257
  prefs: []
  type: TYPE_PRE
  zh: '[PRE41]'
- en: '[22.5.5.2 Customizing the conversion to JSON](#customizing-the-conversion-to-json)'
  id: totrans-258
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '[22.5.5.2 自定义转换为 JSON](#customizing-the-conversion-to-json)'
- en: 'We can customize how an object is converted to JSON by implementing the method
    `.toJSON()`:'
  id: totrans-259
  prefs: []
  type: TYPE_NORMAL
  zh: 我们可以通过实现方法 `.toJSON()` 来自定义对象转换为 JSON 的方式：
- en: '[PRE42]'
  id: totrans-260
  prefs: []
  type: TYPE_PRE
  zh: '[PRE42]'
- en: '[22.6 Comparing strings](#comparing-strings)'
  id: totrans-261
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '[22.6 比较字符串](#comparing-strings)'
- en: 'Strings can be compared via the following operators:'
  id: totrans-262
  prefs: []
  type: TYPE_NORMAL
  zh: 字符串可以通过以下运算符进行比较：
- en: '[PRE43]'
  id: totrans-263
  prefs: []
  type: TYPE_PRE
  zh: '[PRE43]'
- en: 'There is one important caveat to consider: These operators compare based on
    the numeric values of JavaScript characters. That means that the order that JavaScript
    uses for strings is different from the one used in dictionaries and phone books:'
  id: totrans-264
  prefs: []
  type: TYPE_NORMAL
  zh: 有一个重要的注意事项需要考虑：这些运算符是根据 JavaScript 字符的数值进行比较的。这意味着 JavaScript 用于字符串的顺序与字典和电话簿中使用的顺序不同：
- en: '[PRE44]'
  id: totrans-265
  prefs: []
  type: TYPE_PRE
  zh: '[PRE44]'
- en: Properly comparing text is beyond the scope of this book. It is supported via
    [the ECMAScript Internationalization API (`Intl`)](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Intl).
  id: totrans-266
  prefs: []
  type: TYPE_NORMAL
  zh: 正确比较文本超出了本书的范围。它通过 [ECMAScript 国际化 API (`Intl`)](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Intl)
    来支持。
- en: '[22.7 Atoms of text: code points, JavaScript characters, grapheme clusters](#atoms-of-text)'
  id: totrans-267
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '[22.7 文本原子：代码点、JavaScript 字符、图形群组](#atoms-of-text)'
- en: 'Quick recap of [“Unicode – a brief introduction (advanced)” (§21)](ch_unicode.html#ch_unicode):'
  id: totrans-268
  prefs: []
  type: TYPE_NORMAL
  zh: '快速回顾 [“Unicode - 简要介绍（高级）”（§21）](ch_unicode.html#ch_unicode):'
- en: '*Code points* are the atomic parts of Unicode text. Each code point is 21 bits
    in size.'
  id: totrans-269
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*代码点* 是 Unicode 文本的原子部分。每个代码点的大小为 21 位。'
- en: Each *JavaScript* character is a UTF-16 code unit (16 bits). We need one to
    two code units to encode a code point. Most code points fit into one code unit.
  id: totrans-270
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: 每个 *JavaScript* 字符都是一个 UTF-16 代码单元（16 位）。我们需要一个或两个代码单元来编码一个代码点。大多数代码点可以适应一个代码单元。
- en: '*Grapheme clusters* (*user-perceived characters*) represent written symbols,
    as displayed on screen or paper. One or more code points are needed to encode
    a single grapheme cluster. Most grapheme clusters are one code point long.'
  id: totrans-271
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '*图形群组*（*用户感知字符*）代表书写符号，如屏幕或纸张上显示的。编码单个图形群组需要一个或多个代码点。大多数图形群组只有一个代码点长。'
- en: 'The following code demonstrates that a single code point comprises one or two
    JavaScript characters. We count the latter via `.length`:'
  id: totrans-272
  prefs: []
  type: TYPE_NORMAL
  zh: 以下代码演示了一个代码点由一个或两个 JavaScript 字符组成。我们通过 `.length` 来计算后者：
- en: '[PRE45]'
  id: totrans-273
  prefs: []
  type: TYPE_PRE
  zh: '[PRE45]'
- en: 'The following table summarizes the concepts we have just explored:'
  id: totrans-274
  prefs: []
  type: TYPE_NORMAL
  zh: 以下表格总结了我们刚刚探讨的概念：
- en: '| Entity | Size | Encoded via |'
  id: totrans-275
  prefs: []
  type: TYPE_TB
  zh: '| 实体 | 大小 | 编码方式 |'
- en: '| --- | --- | --- |'
  id: totrans-276
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- | --- |'
- en: '| JavaScript character (UTF-16 code unit) | 16 bits | – |'
  id: totrans-277
  prefs: []
  type: TYPE_TB
  zh: '| JavaScript 字符（UTF-16 代码单元） | 16 位 | – |'
- en: '| Unicode code point | 21 bits | 1–2 code units |'
  id: totrans-278
  prefs: []
  type: TYPE_TB
  zh: '| Unicode 代码点 | 21 位 | 1–2 代码单元 |'
- en: '| Unicode grapheme cluster |  | 1+ code points |'
  id: totrans-279
  prefs: []
  type: TYPE_TB
  zh: '| Unicode 图形群组 |  | 1+ 代码点 |'
- en: '[22.7.1 Working with code units (JavaScript characters)](#working-with-code-units-javascript-characters)'
  id: totrans-280
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '[22.7.1 处理代码单元（JavaScript 字符）](#working-with-code-units-javascript-characters)'
- en: Indices and lengths of strings are based on JavaScript characters – which are
    UTF-16 code units.
  id: totrans-281
  prefs: []
  type: TYPE_NORMAL
  zh: 字符串的索引和长度基于 JavaScript 字符——它们是 UTF-16 代码单元。
- en: '[22.7.1.1 Accessing code units](#accessing-code-units)'
  id: totrans-282
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '[22.7.1.1 访问代码单元](#accessing-code-units)'
- en: 'Code units are accessed like Array elements:'
  id: totrans-283
  prefs: []
  type: TYPE_NORMAL
  zh: 代码单元的访问方式类似于数组元素：
- en: '[PRE46]'
  id: totrans-284
  prefs: []
  type: TYPE_PRE
  zh: '[PRE46]'
- en: '`str.split('''')` splits into code units:'
  id: totrans-285
  prefs: []
  type: TYPE_NORMAL
  zh: '`str.split('''')` 按代码单元分割：'
- en: '[PRE47]'
  id: totrans-286
  prefs: []
  type: TYPE_PRE
  zh: '[PRE47]'
- en: The emoji 🙂 consists of two code units.
  id: totrans-287
  prefs: []
  type: TYPE_NORMAL
  zh: 表情符号 🙂 由两个代码单元组成。
- en: '[22.7.1.2 Escaping code units](#escaping-code-units)'
  id: totrans-288
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '[22.7.1.2 转义代码单元](#escaping-code-units)'
- en: 'To specify a code unit hexadecimally, we can use a *Unicode code unit escape*
    with exactly four hexadecimal digits:'
  id: totrans-289
  prefs: []
  type: TYPE_NORMAL
  zh: 要以十六进制形式指定代码单元，我们可以使用恰好四个十六进制数字的 *Unicode 代码单元转义*：
- en: '[PRE48]'
  id: totrans-290
  prefs: []
  type: TYPE_PRE
  zh: '[PRE48]'
- en: '**ASCII escapes:** If the code point of a character is below 256, we can refer
    to it via an *ASCII escape* with exactly two hexadecimal digits:'
  id: totrans-291
  prefs: []
  type: TYPE_NORMAL
  zh: '**ASCII 转义：** 如果字符的代码点小于 256，我们可以通过恰好两个十六进制数字的 *ASCII 转义* 来引用它：'
- en: '[PRE49]'
  id: totrans-292
  prefs: []
  type: TYPE_PRE
  zh: '[PRE49]'
- en: '![Icon “details”](../Images/38ba63de820aae6f94a019538ae0f222.png) **Official
    name of an ASCII escape: hexadecimal escape sequence**'
  id: totrans-293
  prefs: []
  type: TYPE_NORMAL
  zh: '![图标“详情”](../Images/38ba63de820aae6f94a019538ae0f222.png) **ASCII 转义的官方名称：十六进制转义序列**'
- en: It was the first escape that used hexadecimal numbers.
  id: totrans-294
  prefs: []
  type: TYPE_NORMAL
  zh: 这是第一个使用十六进制数的转义。
- en: '[22.7.1.3 Converting code units to numbers (char codes)](#converting-code-units-to-numbers-char-codes)'
  id: totrans-295
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '[22.7.1.3 转换代码单元为数字（字符码）](#converting-code-units-to-numbers-char-codes)'
- en: 'To get the char code of a character, we can use `.charCodeAt()`:'
  id: totrans-296
  prefs: []
  type: TYPE_NORMAL
  zh: 要获取字符的字符码，我们可以使用 `.charCodeAt()`：
- en: '[PRE50]'
  id: totrans-297
  prefs: []
  type: TYPE_PRE
  zh: '[PRE50]'
- en: '`String.fromCharCode()` converts a char code to a string:'
  id: totrans-298
  prefs: []
  type: TYPE_NORMAL
  zh: '`String.fromCharCode()` 将字符码转换为字符串：'
- en: '[PRE51]'
  id: totrans-299
  prefs: []
  type: TYPE_PRE
  zh: '[PRE51]'
- en: '[22.7.2 Working with code points](#working-with-code-points)'
  id: totrans-300
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '[22.7.2 处理代码点](#working-with-code-points)'
- en: '[22.7.2.1 Accessing code points](#accessing-code-points)'
  id: totrans-301
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '[22.7.2.1 访问代码点](#accessing-code-points)'
- en: 'Iteration (which is described [later in this book](ch_sync-iteration.html#ch_sync-iteration))
    splits strings into code points:'
  id: totrans-302
  prefs: []
  type: TYPE_NORMAL
  zh: 迭代（在本书的[后面](ch_sync-iteration.html#ch_sync-iteration)描述）将字符串拆分为代码点：
- en: '[PRE52]'
  id: totrans-303
  prefs: []
  type: TYPE_PRE
  zh: '[PRE52]'
- en: 'Output:'
  id: totrans-304
  prefs: []
  type: TYPE_NORMAL
  zh: 输出：
- en: '[PRE53]'
  id: totrans-305
  prefs: []
  type: TYPE_PRE
  zh: '[PRE53]'
- en: '`Array.from()` uses iteration:'
  id: totrans-306
  prefs: []
  type: TYPE_NORMAL
  zh: '`Array.from()` 使用迭代：'
- en: '[PRE54]'
  id: totrans-307
  prefs: []
  type: TYPE_PRE
  zh: '[PRE54]'
- en: 'Therefore, this is how we can count the number of code points in a string:'
  id: totrans-308
  prefs: []
  type: TYPE_NORMAL
  zh: 因此，这是我们在字符串中计算代码点数量的方法：
- en: '[PRE55]'
  id: totrans-309
  prefs: []
  type: TYPE_PRE
  zh: '[PRE55]'
- en: '[22.7.2.2 Escaping code points](#escaping-code-points)'
  id: totrans-310
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '[22.7.2.2   代码点的转义](#escaping-code-points)'
- en: A *Unicode code point escape* lets us specify a code point hexadecimally (1–5
    digits). It produces one or two JavaScript characters.
  id: totrans-311
  prefs: []
  type: TYPE_NORMAL
  zh: '*Unicode 代码点转义* 允许我们以十六进制形式（1–5 位数字）指定代码点。它产生一个或两个 JavaScript 字符。'
- en: '[PRE56]'
  id: totrans-312
  prefs: []
  type: TYPE_PRE
  zh: '[PRE56]'
- en: '[22.7.2.3 Converting code points in strings to numbers](#converting-code-points-in-strings-to-numbers)'
  id: totrans-313
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '[22.7.2.3   将字符串中的代码点转换为数字](#converting-code-points-in-strings-to-numbers)'
- en: '`.codePointAt()` returns the code point number for a sequence of 1–2 JavaScript
    characters:'
  id: totrans-314
  prefs: []
  type: TYPE_NORMAL
  zh: '`.codePointAt()` 返回 1–2 个 JavaScript 字符序列的代码点数字：'
- en: '[PRE57]'
  id: totrans-315
  prefs: []
  type: TYPE_PRE
  zh: '[PRE57]'
- en: '`String.fromCodePoint()` converts a code point number to 1–2 JavaScript characters:'
  id: totrans-316
  prefs: []
  type: TYPE_NORMAL
  zh: '`String.fromCodePoint()` 将代码点数字转换为 1–2 个 JavaScript 字符：'
- en: '[PRE58]'
  id: totrans-317
  prefs: []
  type: TYPE_PRE
  zh: '[PRE58]'
- en: '[22.7.2.4 Regular expressions for code points](#regular-expressions-for-code-points)'
  id: totrans-318
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '[22.7.2.4   代码点的正则表达式](#regular-expressions-for-code-points)'
- en: 'If we use the flag `/v` for a regular expression, it supports Unicode better
    and matches code points not code units:'
  id: totrans-319
  prefs: []
  type: TYPE_NORMAL
  zh: 如果我们在正则表达式中使用标志 `/v`，它将更好地支持 Unicode 并匹配代码点而不是代码单元：
- en: '[PRE59]'
  id: totrans-320
  prefs: []
  type: TYPE_PRE
  zh: '[PRE59]'
- en: 'More information: [“Flag `/v`: limited support for multi-code-point grapheme
    clusters ^(ES2024)” (§46.11.4)](ch_regexps.html#regexp-flag-unicode-sets).'
  id: totrans-321
  prefs: []
  type: TYPE_NORMAL
  zh: '更多信息：[“标志 `/v`: 对多代码点图形簇的有限支持 (ES2024)” (§46.11.4)](ch_regexps.html#regexp-flag-unicode-sets)。'
- en: '[22.7.3 Working with grapheme clusters](#working-with-grapheme-clusters)'
  id: totrans-322
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '[22.7.3   与图形簇一起工作](#working-with-grapheme-clusters)'
- en: '[22.7.3.1 Accessing grapheme clusters](#accessing-grapheme-clusters)'
  id: totrans-323
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '[22.7.3.1   访问图形簇](#accessing-grapheme-clusters)'
- en: 'This is a grapheme cluster that consists of 3 code points:'
  id: totrans-324
  prefs: []
  type: TYPE_NORMAL
  zh: 这是一个由 3 个代码点组成的图形簇：
- en: '[PRE60]'
  id: totrans-325
  prefs: []
  type: TYPE_PRE
  zh: '[PRE60]'
- en: 'To split a string into grapheme clusters, we can use [`Intl.Segmenter`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Intl/Segmenter)
    – a class that isn’t part of ECMAScript proper, but part of [the ECMAScript internationalization
    API](https://ecma-international.org/publications-and-standards/standards/ecma-402/).
    It is supported by most JavaScript platforms. This is how we can use it:'
  id: totrans-326
  prefs: []
  type: TYPE_NORMAL
  zh: 要将字符串拆分为图形簇，我们可以使用 [Intl.Segmenter](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Intl/Segmenter)
    —— 这是一个不属于 ECMAScript 本身的类，而是 [ECMAScript 国际化 API](https://ecma-international.org/publications-and-standards/standards/ecma-402/)
    的一部分。它被大多数 JavaScript 平台支持。以下是使用它的方法：
- en: '[PRE61]'
  id: totrans-327
  prefs: []
  type: TYPE_PRE
  zh: '[PRE61]'
- en: '`.segmenter()` returns an iterable over segment objects. We can use it via
    `for-of`, `Array.from()`, `Iterator.from()`, etc.'
  id: totrans-328
  prefs: []
  type: TYPE_NORMAL
  zh: '`.segmenter()` 返回一个段对象的可迭代对象。我们可以通过 `for-of`、`Array.from()`、`Iterator.from()`
    等方式使用它。'
- en: '[22.7.3.2 Regular expressions for grapheme clusters](#regular-expressions-for-grapheme-clusters)'
  id: totrans-329
  prefs:
  - PREF_H5
  type: TYPE_NORMAL
  zh: '[22.7.3.2   图形簇的正则表达式](#regular-expressions-for-grapheme-clusters)'
- en: 'The regular expression flag `/v` provides some limited support for grapheme
    clusters – e.g., we can match emojis with potentially multiple code points like
    this:'
  id: totrans-330
  prefs: []
  type: TYPE_NORMAL
  zh: 正则表达式标志 `/v` 为图形簇提供了一些有限的支持——例如，我们可以匹配具有可能多个代码点的表情符号，如下所示：
- en: '[PRE62]'
  id: totrans-331
  prefs: []
  type: TYPE_PRE
  zh: '[PRE62]'
- en: 'More information: [“Flag `/v`: limited support for multi-code-point grapheme
    clusters ^(ES2024)” (§46.11.4)](ch_regexps.html#regexp-flag-unicode-sets).'
  id: totrans-332
  prefs: []
  type: TYPE_NORMAL
  zh: '更多信息：[“标志 `/v`: 对多代码点图形簇的有限支持 (ES2024)” (§46.11.4)](ch_regexps.html#regexp-flag-unicode-sets)。'
- en: '[22.8 Quick reference: Strings](#quickref-string)'
  id: totrans-333
  prefs:
  - PREF_H3
  type: TYPE_NORMAL
  zh: '[22.8   快速参考：字符串](#quickref-string)'
- en: '[22.8.1 Converting to string](#converting-to-string)'
  id: totrans-334
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '[22.8.1   转换为字符串](#converting-to-string)'
- en: '[Table 22.1](#tbl:converting-to-string) describes how various values are converted
    to strings.'
  id: totrans-335
  prefs: []
  type: TYPE_NORMAL
  zh: '[表 22.1](#tbl:converting-to-string) 描述了如何将各种值转换为字符串。'
- en: '| `x` | `String(x)` |'
  id: totrans-336
  prefs: []
  type: TYPE_TB
  zh: '| `x` | `String(x)` |'
- en: '| --- | --- |'
  id: totrans-337
  prefs: []
  type: TYPE_TB
  zh: '| --- | --- |'
- en: '| `undefined` | `''undefined''` |'
  id: totrans-338
  prefs: []
  type: TYPE_TB
  zh: '| `undefined` | `''undefined''` |'
- en: '| `null` | `''null''` |'
  id: totrans-339
  prefs: []
  type: TYPE_TB
  zh: '| `null` | `''null''` |'
- en: '| boolean | `false` → `''false''`, `true` → `''true''` |'
  id: totrans-340
  prefs: []
  type: TYPE_TB
  zh: '| 布尔值 | `false` → `''false''`，`true` → `''true''` |'
- en: '| number | Example: `123` → `''123''` |'
  id: totrans-341
  prefs: []
  type: TYPE_TB
  zh: '| 数字 | 示例：`123` → `''123''` |'
- en: '| bigint | Example: `123n` → `''123''` |'
  id: totrans-342
  prefs: []
  type: TYPE_TB
  zh: '| 大整数 | 示例：`123n` → `''123''` |'
- en: '| string | `x` (input, unchanged) |'
  id: totrans-343
  prefs: []
  type: TYPE_TB
  zh: '| 字符串 | `x` (输入，未更改) |'
- en: '| symbol | Example: `Symbol(''abc'')` → `''Symbol(abc)''` |'
  id: totrans-344
  prefs: []
  type: TYPE_TB
  zh: '| 符号 | 示例：`Symbol(''abc'')` → `''Symbol(abc)''` |'
- en: '| object | Configurable via, e.g., `toString()` |'
  id: totrans-345
  prefs: []
  type: TYPE_TB
  zh: '| 对象 | 可通过例如 `toString()` 配置 |'
- en: 'Table 22.1: Converting values to strings.'
  id: totrans-346
  prefs: []
  type: TYPE_NORMAL
  zh: 表 22.1：将值转换为字符串。
- en: '[22.8.2 Numeric values of text atoms](#numeric-values-of-text-atoms)'
  id: totrans-347
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '[22.8.2   文本原子的数值](#numeric-values-of-text-atoms)'
- en: '**Char code**: number representing a JavaScript character. JavaScript’s name
    for *Unicode code unit*.'
  id: totrans-348
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**字符码**：表示 JavaScript 字符的数字。JavaScript 对 *Unicode 代码单元* 的称呼。'
- en: 'Size: 16 bits, unsigned'
  id: totrans-349
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 大小：16位，无符号
- en: 'Convert number to string: `String.fromCharCode()` ^(ES1)'
  id: totrans-350
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将数字转换为字符串：`String.fromCharCode()`^(ES1)
- en: 'Convert string to number: string method `.charCodeAt()` ^(ES1)'
  id: totrans-351
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将字符串转换为数字：字符串方法`.charCodeAt()`^(ES1)
- en: '**Code point**: number representing an atomic part of Unicode text.'
  id: totrans-352
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '**码点**：表示Unicode文本原子部分的数字。'
- en: 'Size: 21 bits, unsigned (17 planes, 16 bits each)'
  id: totrans-353
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 大小：21位，无符号（17平面，每个16位）
- en: 'Convert number to string: `String.fromCodePoint()` ^(ES6)'
  id: totrans-354
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将数字转换为字符串：`String.fromCodePoint()`^(ES6)
- en: 'Convert string to number: string method `.codePointAt()` ^(ES6)'
  id: totrans-355
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 将字符串转换为数字：字符串方法`.codePointAt()`^(ES6)
- en: '[22.8.3 `String.prototype.*`: regular expression methods](#stringprototype-regular-expression-methods)'
  id: totrans-356
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '[22.8.3 `String.prototype.*`: 正则表达式方法](#stringprototype-regular-expression-methods)'
- en: 'The following methods are listed in [the quick reference for regular expressions](ch_regexps.html#quickref-RegExp):'
  id: totrans-357
  prefs: []
  type: TYPE_NORMAL
  zh: 以下方法列于[正则表达式快速参考](ch_regexps.html#quickref-RegExp)中：
- en: '`String.prototype.match()`'
  id: totrans-358
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`String.prototype.match()`'
- en: '`String.prototype.matchAll()`'
  id: totrans-359
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`String.prototype.matchAll()`'
- en: '`String.prototype.replace()`'
  id: totrans-360
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`String.prototype.replace()`'
- en: '`String.prototype.replaceAll()`'
  id: totrans-361
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`String.prototype.replaceAll()`'
- en: '`String.prototype.search()`'
  id: totrans-362
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`String.prototype.search()`'
- en: '`String.prototype.split()`'
  id: totrans-363
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`String.prototype.split()`'
- en: '[22.8.4 `String.prototype.*`: finding and matching](#stringprototype-finding-and-matching)'
  id: totrans-364
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '[22.8.4 `String.prototype.*`: 查找和匹配](#stringprototype-finding-and-matching)'
- en: '`String.prototype.startsWith(searchString, startPos=0)` ES6'
  id: totrans-365
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`String.prototype.startsWith(searchString, startPos=0)` ES6'
- en: Returns `true` if `searchString` occurs in the string at index `startPos`. Returns
    `false` otherwise.
  id: totrans-366
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 如果`searchString`在字符串中从`startPos`位置出现，则返回`true`。否则返回`false`。
- en: '[PRE63]'
  id: totrans-367
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE63]'
- en: '`String.prototype.endsWith(searchString, endPos=this.length)` ES6'
  id: totrans-368
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`String.prototype.endsWith(searchString, endPos=this.length)` ES6'
- en: Returns `true` if the string would end with `searchString` if its length were
    `endPos`. Returns `false` otherwise.
  id: totrans-369
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 如果字符串长度为`endPos`时以`searchString`结尾，则返回`true`。否则返回`false`。
- en: '[PRE64]'
  id: totrans-370
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE64]'
- en: '`String.prototype.includes(searchString, startPos=0)` ES6'
  id: totrans-371
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`String.prototype.includes(searchString, startPos=0)` ES6'
- en: Returns `true` if the string contains the `searchString` and `false` otherwise.
    The search starts at `startPos`.
  id: totrans-372
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 如果字符串包含`searchString`，则返回`true`，否则返回`false`。搜索从`startPos`开始。
- en: '[PRE65]'
  id: totrans-373
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE65]'
- en: '`String.prototype.indexOf(searchString, minIndex=0)` ES1'
  id: totrans-374
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`String.prototype.indexOf(searchString, minIndex=0)` ES1'
- en: 'If `searchString` appears at `minIndex` or after: Return the lowest index where
    it is found. Otherwise: Return `-1`.'
  id: totrans-375
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果`searchString`出现在`minIndex`或之后：返回它被找到的最低索引。否则：返回`-1`。
- en: '[PRE66]'
  id: totrans-376
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE66]'
- en: '`String.prototype.lastIndexOf(searchString, maxIndex?)` ES1'
  id: totrans-377
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`String.prototype.lastIndexOf(searchString, maxIndex?)` ES1'
- en: 'If `searchString` appears at `maxIndex` or before: Return the highest index
    where it is found. Otherwise: Return `-1`.'
  id: totrans-378
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果`searchString`出现在`maxIndex`或之前：返回它被找到的最高索引。否则：返回`-1`。
- en: If `maxIndex` is missing, the search starts at `this.length - searchString.length`
    (assuming that `searchString` is shorter than `this`).
  id: totrans-379
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果缺少`maxIndex`，搜索从`this.length - searchString.length`开始（假设`searchString`比`this`短）。
- en: '[PRE67]'
  id: totrans-380
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE67]'
- en: '[22.8.5 `String.prototype.*`: extracting](#stringprototype-extracting)'
  id: totrans-381
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '[22.8.5 `String.prototype.*`: 提取](#stringprototype-extracting)'
- en: '`String.prototype.slice(start=0, end=this.length)` ES3'
  id: totrans-382
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`String.prototype.slice(start=0, end=this.length)` ES3'
- en: Returns the substring of the string that starts at (including) index `start`
    and ends at (excluding) index `end`. If an index is negative, it is added to `.length`
    before it is used (`-1` becomes `this.length-1`, etc.).
  id: totrans-383
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 返回从（包括）索引`start`开始到（不包括）索引`end`的字符串子串。如果索引是负数，在它被使用之前会加到`.length`上（`-1`变成`this.length-1`等）。
- en: '[PRE68]'
  id: totrans-384
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE68]'
- en: '`String.prototype.at(index: number)` ES2022'
  id: totrans-385
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`String.prototype.at(index: number)` ES2022'
- en: Returns the JavaScript character at `index` as a string.
  id: totrans-386
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 返回`index`位置的JavaScript字符作为字符串。
- en: If the index is out of bounds, it returns `undefined`.
  id: totrans-387
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果索引超出范围，则返回`undefined`。
- en: If `index` is negative, it is added to `.length` before it is used (`-1` becomes
    `this.length-1`, etc.).
  id: totrans-388
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 如果`index`是负数，在它被使用之前会加到`.length`上（`-1`变成`this.length-1`等）。
- en: '[PRE69]'
  id: totrans-389
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE69]'
- en: '`String.prototype.substring(start, end=this.length)` ES1'
  id: totrans-390
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`String.prototype.substring(start, end=this.length)` ES1'
- en: Use `.slice()` instead of this method. `.substring()` wasn’t implemented consistently
    in older engines and doesn’t support negative indices.
  id: totrans-391
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 使用`.slice()`代替此方法。`.substring()`在旧引擎中实现不一致，并且不支持负索引。
- en: '[22.8.6 `String.prototype.*`: combining](#stringprototype-combining)'
  id: totrans-392
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '[22.8.6 `String.prototype.*`: 组合](#stringprototype-combining)'
- en: '`String.prototype.concat(...strings)` ES3'
  id: totrans-393
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`String.prototype.concat(...strings)` ES3'
- en: Returns the concatenation of the string and `strings`. `'a'.concat('b')` is
    equivalent to `'a'+'b'`. The latter is much more popular.
  id: totrans-394
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 返回字符串和`strings`的连接。`'a'.concat('b')`等价于`'a'+'b'`。后者更为流行。
- en: '[PRE70]'
  id: totrans-395
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE70]'
- en: '`String.prototype.padEnd(len, fillString='' '')` ES2017'
  id: totrans-396
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`String.prototype.padEnd(len, fillString='' '')` ES2017'
- en: Appends (fragments of) `fillString` to the string until it has the desired length
    `len`. If it already has or exceeds `len`, then it is returned without any changes.
  id: totrans-397
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在字符串后面添加（`fillString` 的片段）直到它达到所需的长度 `len`。如果它已经具有或超过 `len`，则返回而不做任何更改。
- en: '[PRE71]'
  id: totrans-398
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE71]'
- en: '`String.prototype.padStart(len, fillString='' '')` ES2017'
  id: totrans-399
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`String.prototype.padStart(len, fillString='' '')` ES2017'
- en: Prepends (fragments of) `fillString` to the string until it has the desired
    length `len`. If it already has or exceeds `len`, then it is returned without
    any changes.
  id: totrans-400
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 在字符串前面添加（`fillString` 的片段）直到它达到所需的长度 `len`。如果它已经具有或超过 `len`，则返回而不做任何更改。
- en: '[PRE72]'
  id: totrans-401
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE72]'
- en: '`String.prototype.repeat(count=0)` ES6'
  id: totrans-402
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`String.prototype.repeat(count=0)` ES6'
- en: Returns the string, concatenated `count` times.
  id: totrans-403
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 返回重复 `count` 次的字符串。
- en: '[PRE73]'
  id: totrans-404
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE73]'
- en: '[22.8.7 `String.prototype.*`: transforming](#stringprototype-transforming)'
  id: totrans-405
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '[22.8.7 `String.prototype.*`: 转换](#stringprototype-transforming)'
- en: '`String.prototype.toUpperCase()` ES1'
  id: totrans-406
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`String.prototype.toUpperCase()` ES1'
- en: Returns a copy of the string in which all lowercase alphabetic characters are
    converted to uppercase. How well that works for various alphabets, depends on
    the JavaScript engine.
  id: totrans-407
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 返回一个副本，其中所有小写字母字符都被转换为大写字母。这对于各种字母表的效果取决于JavaScript引擎。
- en: '[PRE74]'
  id: totrans-408
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE74]'
- en: '`String.prototype.toLowerCase()` ES1'
  id: totrans-409
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`String.prototype.toLowerCase()` ES1'
- en: Returns a copy of the string in which all uppercase alphabetic characters are
    converted to lowercase. How well that works for various alphabets, depends on
    the JavaScript engine.
  id: totrans-410
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 返回一个副本，其中所有大写字母字符都被转换为小写字母。这对于各种字母表的效果取决于JavaScript引擎。
- en: '[PRE75]'
  id: totrans-411
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE75]'
- en: '`String.prototype.trim()` ES5'
  id: totrans-412
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`String.prototype.trim()` ES5'
- en: Returns a copy of the string in which all leading and trailing whitespace (spaces,
    tabs, line terminators, etc.) is gone.
  id: totrans-413
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 返回一个没有前导和尾随空白（空格、制表符、行终止符等）的字符串副本。
- en: '[PRE76]'
  id: totrans-414
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE76]'
- en: '`String.prototype.trimStart()` ES2019'
  id: totrans-415
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`String.prototype.trimStart()` ES2019'
- en: 'Similar to `.trim()` but only the beginning of the string is trimmed:'
  id: totrans-416
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 与 `.trim()` 类似，但仅删除字符串的开头：
- en: '[PRE77]'
  id: totrans-417
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE77]'
- en: '`String.prototype.trimEnd()` ES2019'
  id: totrans-418
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`String.prototype.trimEnd()` ES2019'
- en: 'Similar to `.trim()` but only the end of the string is trimmed:'
  id: totrans-419
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 与 `.trim()` 类似，但仅删除字符串的末尾：
- en: '[PRE78]'
  id: totrans-420
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE78]'
- en: '`String.prototype.normalize(form = ''NFC'')` ES6'
  id: totrans-421
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`String.prototype.normalize(form = ''NFC'')` ES6'
- en: Normalizes the string according to [the Unicode Normalization Forms](https://unicode.org/reports/tr15/).
  id: totrans-422
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: 根据Unicode规范化形式规范化字符串。[Unicode规范化形式](https://unicode.org/reports/tr15/)
- en: 'Values of `form`: `''NFC'', ''NFD'', ''NFKC'', ''NFKD''`'
  id: totrans-423
  prefs:
  - PREF_IND
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`form` 的值：`''NFC'', ''NFD'', ''NFKC'', ''NFKD''`'
- en: '`String.prototype.isWellFormed()` ES2024'
  id: totrans-424
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`String.prototype.isWellFormed()` ES2024'
- en: Returns `true` if a string is ill-formed and contains *lone surrogates* (see
    [`.toWellFormed()`](#qref-String.prototype.toWellFormed) for more information).
    Otherwise, it returns `false`.
  id: totrans-425
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 如果字符串格式不正确且包含 *lone surrogates*（有关更多信息，请参阅[`.toWellFormed()`](#qref-String.prototype.toWellFormed)），则返回
    `true`。否则，返回 `false`。
- en: '[PRE79]'
  id: totrans-426
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE79]'
- en: '`String.prototype.toWellFormed()` ES2024'
  id: totrans-427
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '`String.prototype.toWellFormed()` ES2024'
- en: Each JavaScript string character is a [UTF-16 code unit](ch_unicode.html#utf-16).
    One code point is encoded as either one UTF-16 code unit or two UTF-16 code unit.
    In the latter case, the two code units are called *leading surrogate* and *trailing
    surrogate*. A surrogate without its partner is called a *lone surrogate*. A string
    with one or more lone surrogates is *ill-formed*.
  id: totrans-428
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: 每个JavaScript字符串字符都是一个 [UTF-16 代码单元](ch_unicode.html#utf-16)。一个代码点被编码为一个或两个UTF-16代码单元。在后一种情况下，这两个代码单元被称为
    *leading surrogate* 和 *trailing surrogate*。没有其配对的代理字符被称为 *lone surrogate*。包含一个或多个单独代理字符的字符串是
    *ill-formed*。
- en: '`.toWellFormed()` converts an ill-formed string to a well-formed one by replacing
    each lone surrogate with code point 0xFFFD (“replacement character”). That character
    is often displayed as a � (a black rhombus with a white question mark). It is
    located in the *Specials* Unicode block of characters, at the very end of the
    *Basic Multilingual Plane*. [This is what Wikipedia says about the replacement
    character](https://en.wikipedia.org/wiki/Specials_%28Unicode_block%29#Replacement_character):
    “It is used to indicate problems when a system is unable to render a stream of
    data to correct symbols.”'
  id: totrans-429
  prefs:
  - PREF_IND
  type: TYPE_NORMAL
  zh: '`.toWellFormed()` 将一个格式不正确的字符串转换为格式正确的字符串，通过将每个单独的代理字符替换为代码点 0xFFFD（“替换字符”）。该字符通常显示为
    �（一个带有白色问号的黑色菱形）。它位于字符的 *Specials* Unicode 块中，位于 *Basic Multilingual Plane* 的末尾。[这是维基百科关于替换字符的说明](https://en.wikipedia.org/wiki/Specials_%28Unicode_block%29#Replacement_character)：
    “它用于指示当系统无法将数据流渲染为正确的符号时出现的问题。”'
- en: '[PRE80]'
  id: totrans-430
  prefs:
  - PREF_IND
  type: TYPE_PRE
  zh: '[PRE80]'
- en: '[22.8.8 Sources of this quick reference](#sources-of-this-quick-reference)'
  id: totrans-431
  prefs:
  - PREF_H4
  type: TYPE_NORMAL
  zh: '[22.8.8 本快速参考的来源](#sources-of-this-quick-reference)'
- en: '[ECMAScript language specification](https://tc39.es/ecma262/)'
  id: totrans-432
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[ECMAScript 语言规范](https://tc39.es/ecma262/)'
- en: '[TypeScript’s built-in typings](https://github.com/microsoft/TypeScript/tree/main/src/lib/)'
  id: totrans-433
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[TypeScript 内置类型定义](https://github.com/microsoft/TypeScript/tree/main/src/lib/)'
- en: '[MDN web docs for JavaScript](https://developer.mozilla.org/en-US/docs/Web/JavaScript)'
  id: totrans-434
  prefs:
  - PREF_UL
  type: TYPE_NORMAL
  zh: '[MDN 网页文档中的 JavaScript](https://developer.mozilla.org/en-US/docs/Web/JavaScript)'
- en: '![Icon “exercise”](../Images/4fc2ec98bb44cc1f4de7c6a46d9dd043.png) **Exercise:
    Using string methods**'
  id: totrans-435
  prefs: []
  type: TYPE_NORMAL
  zh: '![“练习”图标](../Images/4fc2ec98bb44cc1f4de7c6a46d9dd043.png) **练习：使用字符串方法**'
- en: '`exercises/strings/remove_extension_test.mjs`'
  id: totrans-436
  prefs: []
  type: TYPE_NORMAL
  zh: '`exercises/strings/remove_extension_test.mjs`'
